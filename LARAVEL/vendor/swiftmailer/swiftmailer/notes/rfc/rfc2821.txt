





Network Working Group                                 J. Klensin, Editor
Request for Comments: 2821                             AT&T Laboratories
Obsoletes: 821, 974, 1869                                     April 2001
Updates: 1123
Category: Standards Track


                     Simple Mail Transfer Protocol

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2001).  All Rights Reserved.

Abstract

   This document is a self-contained specification of the basic protocol
   for the Internet electronic mail transport.  It consolidates, updates
   and clarifies, but doesn't add new or change existing functionality
   of the following:

   -  the original SMTP (Simple Mail Transfer Protocol) specification of
      RFC 821 [30],

   -  domain name system requirements and implications for mail
      transport from RFC 1035 [22] and RFC 974 [27],

   -  the clarifications and applicability statements in RFC 1123 [2],
      and

   -  material drawn from the SMTP Extension mechanisms [19].

   It obsoletes RFC 821, RFC 974, and updates RFC 1123 (replaces the
   mail transport materials of RFC 1123).  However, RFC 821 specifies
   some features that were not in significant use in the Internet by the
   mid-1990s and (in appendices) some additional transport models.
   Those sections are omitted here in the interest of clarity and
   brevity; readers needing them should refer to RFC 821.






Klensin                     Standards Track                     [Page 1]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   It also includes some additional material from RFC 1123 that required
   amplification.  This material has been identified in multiple ways,
   mostly by tracking flaming on various lists and newsgroups and
   problems of unusual readings or interpretations that have appeared as
   the SMTP extensions have been deployed.  Where this specification
   moves beyond consolidation and actually differs from earlier
   documents, it supersedes them technically as well as textually.

   Although SMTP was designed as a mail transport and delivery protocol,
   this specification also contains information that is important to its
   use as a 'mail submission' protocol, as recommended for POP [3, 26]
   and IMAP [6].  Additional submission issues are discussed in RFC 2476
   [15].

   Section 2.3 provides definitions of terms specific to this document.
   Except when the historical terminology is necessary for clarity, this
   document uses the current 'client' and 'server' terminology to
   identify the sending and receiving SMTP processes, respectively.

   A companion document [32] discusses message headers, message bodies
   and formats and structures for them, and their relationship.

Table of Contents

   1. Introduction ..................................................  4
   2. The SMTP Model ................................................  5
   2.1 Basic Structure ..............................................  5
   2.2 The Extension Model ..........................................  7
   2.2.1 Background .................................................  7
   2.2.2 Definition and Registration of Extensions ..................  8
   2.3 Terminology ..................................................  9
   2.3.1 Mail Objects ............................................... 10
   2.3.2 Senders and Receivers ...................................... 10
   2.3.3 Mail Agents and Message Stores ............................. 10
   2.3.4 Host ....................................................... 11
   2.3.5 Domain ..................................................... 11
   2.3.6 Buffer and State Table ..................................... 11
   2.3.7 Lines ...................................................... 12
   2.3.8 Originator, Delivery, Relay, and Gateway Systems ........... 12
   2.3.9 Message Content and Mail Data .............................. 13
   2.3.10 Mailbox and Address ....................................... 13
   2.3.11 Reply ..................................................... 13
   2.4 General Syntax Principles and Transaction Model .............. 13
   3. The SMTP Procedures: An Overview .............................. 15
   3.1 Session Initiation ........................................... 15
   3.2 Client Initiation ............................................ 16
   3.3 Mail Transactions ............................................ 16
   3.4 Forwarding for Address Correction or Updating ................ 19



Klensin                     Standards Track                     [Page 2]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   3.5 Commands for Debugging Addresses ............................. 20
   3.5.1 Overview ................................................... 20
   3.5.2 VRFY Normal Response ....................................... 22
   3.5.3 Meaning of VRFY or EXPN Success Response ................... 22
   3.5.4 Semantics and Applications of EXPN ......................... 23
   3.6 Domains ...................................................... 23
   3.7 Relaying ..................................................... 24
   3.8 Mail Gatewaying .............................................. 25
   3.8.1 Header Fields in Gatewaying ................................ 26
   3.8.2 Received Lines in Gatewaying ............................... 26
   3.8.3 Addresses in Gatewaying .................................... 26
   3.8.4 Other Header Fields in Gatewaying .......................... 27
   3.8.5 Envelopes in Gatewaying .................................... 27
   3.9 Terminating Sessions and Connections ......................... 27
   3.10 Mailing Lists and Aliases ................................... 28
   3.10.1 Alias ..................................................... 28
   3.10.2 List ...................................................... 28
   4. The SMTP Specifications ....................................... 29
   4.1 SMTP Commands ................................................ 29
   4.1.1 Command Semantics and Syntax ............................... 29
   4.1.1.1  Extended HELLO (EHLO) or HELLO (HELO) ................... 29
   4.1.1.2 MAIL (MAIL) .............................................. 31
   4.1.1.3 RECIPIENT (RCPT) ......................................... 31
   4.1.1.4 DATA (DATA) .............................................. 33
   4.1.1.5 RESET (RSET) ............................................. 34
   4.1.1.6 VERIFY (VRFY) ............................................ 35
   4.1.1.7 EXPAND (EXPN) ............................................ 35
   4.1.1.8 HELP (HELP) .............................................. 35
   4.1.1.9 NOOP (NOOP) .............................................. 35
   4.1.1.10 QUIT (QUIT) ............................................. 36
   4.1.2 Command Argument Syntax .................................... 36
   4.1.3 Address Literals ........................................... 38
   4.1.4 Order of Commands .......................................... 39
   4.1.5 Private-use Commands ....................................... 40
   4.2  SMTP Replies ................................................ 40
   4.2.1 Reply Code Severities and Theory ........................... 42
   4.2.2 Reply Codes by Function Groups ............................. 44
   4.2.3  Reply Codes in Numeric Order .............................. 45
   4.2.4 Reply Code 502 ............................................. 46
   4.2.5 Reply Codes After DATA and the Subsequent <CRLF>.<CRLF> .... 46
   4.3 Sequencing of Commands and Replies ........................... 47
   4.3.1 Sequencing Overview ........................................ 47
   4.3.2 Command-Reply Sequences .................................... 48
   4.4 Trace Information ............................................ 49
   4.5 Additional Implementation Issues ............................. 53
   4.5.1 Minimum Implementation ..................................... 53
   4.5.2 Transparency ............................................... 53
   4.5.3 Sizes and Timeouts ......................................... 54



Klensin                     Standards Track                     [Page 3]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   4.5.3.1 Size limits and minimums ................................. 54
   4.5.3.2 Timeouts ................................................. 56
   4.5.4 Retry Strategies ........................................... 57
   4.5.4.1 Sending Strategy ......................................... 58
   4.5.4.2 Receiving Strategy ....................................... 59
   4.5.5 Messages with a null reverse-path .......................... 59
   5. Address Resolution and Mail Handling .......................... 60
   6. Problem Detection and Handling ................................ 62
   6.1 Reliable Delivery and Replies by Email ....................... 62
   6.2 Loop Detection ............................................... 63
   6.3 Compensating for Irregularities .............................. 63
   7. Security Considerations ....................................... 64
   7.1 Mail Security and Spoofing ................................... 64
   7.2 "Blind" Copies ............................................... 65
   7.3 VRFY, EXPN, and Security ..................................... 65
   7.4 Information Disclosure in Announcements ...................... 66
   7.5 Information Disclosure in Trace Fields ....................... 66
   7.6 Information Disclosure in Message Forwarding ................. 67
   7.7 Scope of Operation of SMTP Servers ........................... 67
   8. IANA Considerations ........................................... 67
   9. References .................................................... 68
   10. Editor's Address ............................................. 70
   11. Acknowledgments .............................................. 70
   Appendices ....................................................... 71
   A. TCP Transport Service ......................................... 71
   B. Generating SMTP Commands from RFC 822 Headers ................. 71
   C. Source Routes ................................................. 72
   D. Scenarios ..................................................... 73
   E. Other Gateway Issues .......................................... 76
   F. Deprecated Features of RFC 821 ................................ 76
   Full Copyright Statement ......................................... 79

1. Introduction

   The objective of the Simple Mail Transfer Protocol (SMTP) is to
   transfer mail reliably and efficiently.

   SMTP is independent of the particular transmission subsystem and
   requires only a reliable ordered data stream channel.  While this
   document specifically discusses transport over TCP, other transports
   are possible.  Appendices to RFC 821 describe some of them.

   An important feature of SMTP is its capability to transport mail
   across networks, usually referred to as "SMTP mail relaying" (see
   section 3.8).  A network consists of the mutually-TCP-accessible
   hosts on the public Internet, the mutually-TCP-accessible hosts on a
   firewall-isolated TCP/IP Intranet, or hosts in some other LAN or WAN
   environment utilizing a non-TCP transport-level protocol.  Using



Klensin                     Standards Track                     [Page 4]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   SMTP, a process can transfer mail to another process on the same
   network or to some other network via a relay or gateway process
   accessible to both networks.

   In this way, a mail message may pass through a number of intermediate
   relay or gateway hosts on its path from sender to ultimate recipient.
   The Mail eXchanger mechanisms of the domain name system [22, 27] (and
   section 5 of this document) are used to identify the appropriate
   next-hop destination for a message being transported.

2. The SMTP Model

2.1 Basic Structure

   The SMTP design can be pictured as:

               +----------+                +----------+
   +------+    |          |                |          |
   | User |<-->|          |      SMTP      |          |
   +------+    |  Client- |Commands/Replies| Server-  |
   +------+    |   SMTP   |<-------------->|    SMTP  |    +------+
   | File |<-->|          |    and Mail    |          |<-->| File |
   |System|    |          |                |          |    |System|
   +------+    +----------+                +----------+    +------+
                SMTP client                SMTP server

   When an SMTP client has a message to transmit, it establishes a two-
   way transmission channel to an SMTP server.  The responsibility of an
   SMTP client is to transfer mail messages to one or more SMTP servers,
   or report its failure to do so.

   The means by which a mail message is presented to an SMTP client, and
   how that client determines the domain name(s) to which mail messages
   are to be transferred is a local matter, and is not addressed by this
   document.  In some cases, the domain name(s) transferred to, or
   determined by, an SMTP client will identify the final destination(s)
   of the mail message.  In other cases, common with SMTP clients
   associated with implementations of the POP [3, 26] or IMAP [6]
   protocols, or when the SMTP client is inside an isolated transport
   service environment, the domain name determined will identify an
   intermediate destination through which all mail messages are to be
   relayed.  SMTP clients that transfer all traffic, regardless of the
   target domain names associated with the individual messages, or that
   do not maintain queues for retrying message transmissions that
   initially cannot be completed, may otherwise conform to this
   specification but are not considered fully-capable.  Fully-capable
   SMTP implementations, including the relays used by these less capable




Klensin                     Standards Track                     [Page 5]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   ones, and their destinations, are expected to support all of the
   queuing, retrying, and alternate address functions discussed in this
   specification.

   The means by which an SMTP client, once it has determined a target
   domain name, determines the identity of an SMTP server to which a
   copy of a message is to be transferred, and then performs that
   transfer, is covered by this document.  To effect a mail transfer to
   an SMTP server, an SMTP client establishes a two-way transmission
   channel to that SMTP server.  An SMTP client determines the address
   of an appropriate host running an SMTP server by resolving a
   destination domain name to either an intermediate Mail eXchanger host
   or a final target host.

   An SMTP server may be either the ultimate destination or an
   intermediate "relay" (that is, it may assume the role of an SMTP
   client after receiving the message) or "gateway" (that is, it may
   transport the message further using some protocol other than SMTP).
   SMTP commands are generated by the SMTP client and sent to the SMTP
   server.  SMTP replies are sent from the SMTP server to the SMTP
   client in response to the commands.

   In other words, message transfer can occur in a single connection
   between the original SMTP-sender and the final SMTP-recipient, or can
   occur in a series of hops through intermediary systems.  In either
   case, a formal handoff of responsibility for the message occurs: the
   protocol requires that a server accept responsibility for either
   delivering a message or properly reporting the failure to do so.

   Once the transmission channel is established and initial handshaking
   completed, the SMTP client normally initiates a mail transaction.
   Such a transaction consists of a series of commands to specify the
   originator and destination of the mail and transmission of the
   message content (including any headers or other structure) itself.
   When the same message is sent to multiple recipients, this protocol
   encourages the transmission of only one copy of the data for all
   recipients at the same destination (or intermediate relay) host.

   The server responds to each command with a reply; replies may
   indicate that the command was accepted, that additional commands are
   expected, or that a temporary or permanent error condition exists.
   Commands specifying the sender or recipients may include server-
   permitted SMTP service extension requests as discussed in section
   2.2.  The dialog is purposely lock-step, one-at-a-time, although this
   can be modified by mutually-agreed extension requests such as command
   pipelining [13].





Klensin                     Standards Track                     [Page 6]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   Once a given mail message has been transmitted, the client may either
   request that the connection be shut down or may initiate other mail
   transactions.  In addition, an SMTP client may use a connection to an
   SMTP server for ancillary services such as verification of email
   addresses or retrieval of mailing list subscriber addresses.

   As suggested above, this protocol provides mechanisms for the
   transmission of mail.  This transmission normally occurs directly
   from the sending user's host to the receiving user's host when the
   two hosts are connected to the same transport service.  When they are
   not connected to the same transport service, transmission occurs via
   one or more relay SMTP servers.  An intermediate host that acts as
   either an SMTP relay or as a gateway into some other transmission
   environment is usually selected through the use of the domain name
   service (DNS) Mail eXchanger mechanism.

   Usually, intermediate hosts are determined via the DNS MX record, not
   by explicit "source" routing (see section 5 and appendices C and
   F.2).

2.2 The Extension Model

2.2.1 Background

   In an effort that started in 1990, approximately a decade after RFC
   821 was completed, the protocol was modified with a "service
   extensions" model that permits the client and server to agree to
   utilize shared functionality beyond the original SMTP requirements.
   The SMTP extension mechanism defines a means whereby an extended SMTP
   client and server may recognize each other, and the server can inform
   the client as to the service extensions that it supports.

   Contemporary SMTP implementations MUST support the basic extension
   mechanisms.  For instance, servers MUST support the EHLO command even
   if they do not implement any specific extensions and clients SHOULD
   preferentially utilize EHLO rather than HELO.  (However, for
   compatibility with older conforming implementations, SMTP clients and
   servers MUST support the original HELO mechanisms as a fallback.)
   Unless the different characteristics of HELO must be identified for
   interoperability purposes, this document discusses only EHLO.

   SMTP is widely deployed and high-quality implementations have proven
   to be very robust.  However, the Internet community now considers
   some services to be important that were not anticipated when the
   protocol was first designed.  If support for those services is to be
   added, it must be done in a way that permits older implementations to
   continue working acceptably.  The extension framework consists of:




Klensin                     Standards Track                     [Page 7]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   -  The SMTP command EHLO, superseding the earlier HELO,

   -  a registry of SMTP service extensions,

   -  additional parameters to the SMTP MAIL and RCPT commands, and

   -  optional replacements for commands defined in this protocol, such
      as for DATA in non-ASCII transmissions [33].

   SMTP's strength comes primarily from its simplicity.  Experience with
   many protocols has shown that protocols with few options tend towards
   ubiquity, whereas protocols with many options tend towards obscurity.

   Each and every extension, regardless of its benefits, must be
   carefully scrutinized with respect to its implementation, deployment,
   and interoperability costs.  In many cases, the cost of extending the
   SMTP service will likely outweigh the benefit.

2.2.2 Definition and Registration of Extensions

   The IANA maintains a registry of SMTP service extensions.  A
   corresponding EHLO keyword value is associated with each extension.
   Each service extension registered with the IANA must be defined in a
   formal standards-track or IESG-approved experimental protocol
   document.  The definition must include:

   -  the textual name of the SMTP service extension;

   -  the EHLO keyword value associated with the extension;

   -  the syntax and possible values of parameters associated with the
      EHLO keyword value;

   -  any additional SMTP verbs associated with the extension
      (additional verbs will usually be, but are not required to be, the
      same as the EHLO keyword value);

   -  any new parameters the extension associates with the MAIL or RCPT
      verbs;

   -  a description of how support for the extension affects the
      behavior of a server and client SMTP; and,

   -  the increment by which the extension is increasing the maximum
      length of the commands MAIL and/or RCPT, over that specified in
      this standard.





Klensin                     Standards Track                     [Page 8]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   In addition, any EHLO keyword value starting with an upper or lower
   case "X" refers to a local SMTP service extension used exclusively
   through bilateral agreement.  Keywords beginning with "X" MUST NOT be
   used in a registered service extension.  Conversely, keyword values
   presented in the EHLO response that do not begin with "X" MUST
   correspond to a standard, standards-track, or IESG-approved
   experimental SMTP service extension registered with IANA.  A
   conforming server MUST NOT offer non-"X"-prefixed keyword values that
   are not described in a registered extension.

   Additional verbs and parameter names are bound by the same rules as
   EHLO keywords; specifically, verbs beginning with "X" are local
   extensions that may not be registered or standardized.  Conversely,
   verbs not beginning with "X" must always be registered.

2.3 Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described below.

   1. MUST   This word, or the terms "REQUIRED" or "SHALL", mean that
      the definition is an absolute requirement of the specification.

   2. MUST NOT   This phrase, or the phrase "SHALL NOT", mean that the
      definition is an absolute prohibition of the specification.

   3. SHOULD   This word, or the adjective "RECOMMENDED", mean that
      there may exist valid reasons in particular circumstances to
      ignore a particular item, but the full implications must be
      understood and carefully weighed before choosing a different
      course.

   4. SHOULD NOT   This phrase, or the phrase "NOT RECOMMENDED" mean
      that there may exist valid reasons in particular circumstances
      when the particular behavior is acceptable or even useful, but the
      full implications should be understood and the case carefully
      weighed before implementing any behavior described with this
      label.

   5. MAY   This word, or the adjective "OPTIONAL", mean that an item is
      truly optional.  One vendor may choose to include the item because
      a particular marketplace requires it or because the vendor feels
      that it enhances the product while another vendor may omit the
      same item.  An implementation which does not include a particular
      option MUST be prepared to interoperate with another
      implementation which does include the option, though perhaps with
      reduced functionality.  In the same vein an implementation which



Klensin                     Standards Track                     [Page 9]

RFC 2821             Simple Mail Transfer Protocol            April 2001


      does include a particular option MUST be prepared to interoperate
      with another implementation which does not include the option
      (except, of course, for the feature the option provides.)

2.3.1 Mail Objects

   SMTP transports a mail object.  A mail object contains an envelope
   and content.

   The SMTP envelope is sent as a series of SMTP protocol units
   (described in section 3).  It consists of an originator address (to
   which error reports should be directed); one or more recipient
   addresses; and optional protocol extension material.  Historically,
   variations on the recipient address specification command (RCPT TO)
   could be used to specify alternate delivery modes, such as immediate
   display; those variations have now been deprecated (see appendix F,
   section F.6).

   The SMTP content is sent in the SMTP DATA protocol unit and has two
   parts:  the headers and the body.  If the content conforms to other
   contemporary standards, the headers form a collection of field/value
   pairs structured as in the message format specification [32]; the
   body, if structured, is defined according to MIME [12].  The content
   is textual in nature, expressed using the US-ASCII repertoire [1].
   Although SMTP extensions (such as "8BITMIME" [20]) may relax this
   restriction for the content body, the content headers are always
   encoded using the US-ASCII repertoire.  A MIME extension [23] defines
   an algorithm for representing header values outside the US-ASCII
   repertoire, while still encoding them using the US-ASCII repertoire.

2.3.2 Senders and Receivers

   In RFC 821, the two hosts participating in an SMTP transaction were
   described as the "SMTP-sender" and "SMTP-receiver".  This document
   has been changed to reflect current industry terminology and hence
   refers to them as the "SMTP client" (or sometimes just "the client")
   and "SMTP server" (or just "the server"), respectively.  Since a
   given host may act both as server and client in a relay situation,
   "receiver" and "sender" terminology is still used where needed for
   clarity.

2.3.3 Mail Agents and Message Stores

   Additional mail system terminology became common after RFC 821 was
   published and, where convenient, is used in this specification.  In
   particular, SMTP servers and clients provide a mail transport service
   and therefore act as "Mail Transfer Agents" (MTAs).  "Mail User
   Agents" (MUAs or UAs) are normally thought of as the sources and



Klensin                     Standards Track                    [Page 10]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   targets of mail.  At the source, an MUA might collect mail to be
   transmitted from a user and hand it off to an MTA; the final
   ("delivery") MTA would be thought of as handing the mail off to an
   MUA (or at least transferring responsibility to it, e.g., by
   depositing the message in a "message store").  However, while these
   terms are used with at least the appearance of great precision in
   other environments, the implied boundaries between MUAs and MTAs
   often do not accurately match common, and conforming, practices with
   Internet mail.  Hence, the reader should be cautious about inferring
   the strong relationships and responsibilities that might be implied
   if these terms were used elsewhere.

2.3.4 Host

   For the purposes of this specification, a host is a computer system
   attached to the Internet (or, in some cases, to a private TCP/IP
   network) and supporting the SMTP protocol.  Hosts are known by names
   (see "domain"); identifying them by numerical address is discouraged.

2.3.5 Domain

   A domain (or domain name) consists of one or more dot-separated
   components.  These components ("labels" in DNS terminology [22]) are
   restricted for SMTP purposes to consist of a sequence of letters,
   digits, and hyphens drawn from the ASCII character set [1].  Domain
   names are used as names of hosts and of other entities in the domain
   name hierarchy.  For example, a domain may refer to an alias (label
   of a CNAME RR) or the label of Mail eXchanger records to be used to
   deliver mail instead of representing a host name.  See [22] and
   section 5 of this specification.

   The domain name, as described in this document and in [22], is the
   entire, fully-qualified name (often referred to as an "FQDN").  A
   domain name that is not in FQDN form is no more than a local alias.
   Local aliases MUST NOT appear in any SMTP transaction.

2.3.6 Buffer and State Table

   SMTP sessions are stateful, with both parties carefully maintaining a
   common view of the current state.  In this document we model this
   state by a virtual "buffer" and a "state table" on the server which
   may be used by the client to, for example, "clear the buffer" or
   "reset the state table," causing the information in the buffer to be
   discarded and the state to be returned to some previous state.







Klensin                     Standards Track                    [Page 11]

RFC 2821             Simple Mail Transfer Protocol            April 2001


2.3.7 Lines

   SMTP commands and, unless altered by a service extension, message
   data, are transmitted in "lines".  Lines consist of zero or more data
   characters terminated by the sequence ASCII character "CR" (hex value
   0D) followed immediately by ASCII character "LF" (hex value 0A).
   This termination sequence is denoted as <CRLF> in this document.
   Conforming implementations MUST NOT recognize or generate any other
   character or character sequence as a line terminator.  Limits MAY be
   imposed on line lengths by servers (see section 4.5.3).

   In addition, the appearance of "bare" "CR" or "LF" characters in text
   (i.e., either without the other) has a long history of causing
   problems in mail implementations and applications that use the mail
   system as a tool.  SMTP client implementations MUST NOT transmit
   these characters except when they are intended as line terminators
   and then MUST, as indicated above, transmit them only as a <CRLF>
   sequence.

2.3.8 Originator, Delivery, Relay, and Gateway Systems

   This specification makes a distinction among four types of SMTP
   systems, based on the role those systems play in transmitting
   electronic mail.  An "originating" system (sometimes called an SMTP
   originator) introduces mail into the Internet or, more generally,
   into a transport service environment.  A "delivery" SMTP system is
   one that receives mail from a transport service environment and
   passes it to a mail user agent or deposits it in a message store
   which a mail user agent is expected to subsequently access.  A
   "relay" SMTP system (usually referred to just as a "relay") receives
   mail from an SMTP client and transmits it, without modification to
   the message data other than adding trace information, to another SMTP
   server for further relaying or for delivery.

   A "gateway" SMTP system (usually referred to just as a "gateway")
   receives mail from a client system in one transport environment and
   transmits it to a server system in another transport environment.
   Differences in protocols or message semantics between the transport
   environments on either side of a gateway may require that the gateway
   system perform transformations to the message that are not permitted
   to SMTP relay systems.  For the purposes of this specification,
   firewalls that rewrite addresses should be considered as gateways,
   even if SMTP is used on both sides of them (see [11]).








Klensin                     Standards Track                    [Page 12]

RFC 2821             Simple Mail Transfer Protocol            April 2001


2.3.9 Message Content and Mail Data

   The terms "message content" and "mail data" are used interchangeably
   in this document to describe the material transmitted after the DATA
   command is accepted and before the end of data indication is
   transmitted.  Message content includes message headers and the
   possibly-structured message body.  The MIME specification [12]
   provides the standard mechanisms for structured message bodies.

2.3.10 Mailbox and Address

   As used in this specification, an "address" is a character string
   that identifies a user to whom mail will be sent or a location into
   which mail will be deposited.  The term "mailbox" refers to that
   depository.  The two terms are typically used interchangeably unless
   the distinction between the location in which mail is placed (the
   mailbox) and a reference to it (the address) is important.  An
   address normally consists of user and domain specifications.  The
   standard mailbox naming convention is defined to be "local-
   part@domain": contemporary usage permits a much broader set of
   applications than simple "user names".  Consequently, and due to a
   long history of problems when intermediate hosts have attempted to
   optimize transport by modifying them, the local-part MUST be
   interpreted and assigned semantics only by the host specified in the
   domain part of the address.

2.3.11 Reply

   An SMTP reply is an acknowledgment (positive or negative) sent from
   receiver to sender via the transmission channel in response to a
   command.  The general form of a reply is a numeric completion code
   (indicating failure or success) usually followed by a text string.
   The codes are for use by programs and the text is usually intended
   for human users.  Recent work [34] has specified further structuring
   of the reply strings, including the use of supplemental and more
   specific completion codes.

2.4 General Syntax Principles and Transaction Model

   SMTP commands and replies have a rigid syntax.  All commands begin
   with a command verb.  All Replies begin with a three digit numeric
   code.  In some commands and replies, arguments MUST follow the verb
   or reply code.  Some commands do not accept arguments (after the
   verb), and some reply codes are followed, sometimes optionally, by
   free form text.  In both cases, where text appears, it is separated
   from the verb or reply code by a space character.  Complete
   definitions of commands and replies appear in section 4.




Klensin                     Standards Track                    [Page 13]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   Verbs and argument values (e.g., "TO:" or "to:" in the RCPT command
   and extension name keywords) are not case sensitive, with the sole
   exception in this specification of a mailbox local-part (SMTP
   Extensions may explicitly specify case-sensitive elements).  That is,
   a command verb, an argument value other than a mailbox local-part,
   and free form text MAY be encoded in upper case, lower case, or any
   mixture of upper and lower case with no impact on its meaning.  This
   is NOT true of a mailbox local-part.  The local-part of a mailbox
   MUST BE treated as case sensitive.  Therefore, SMTP implementations
   MUST take care to preserve the case of mailbox local-parts.  Mailbox
   domains are not case sensitive.  In particular, for some hosts the
   user "smith" is different from the user "Smith".  However, exploiting
   the case sensitivity of mailbox local-parts impedes interoperability
   and is discouraged.

   A few SMTP servers, in violation of this specification (and RFC 821)
   require that command verbs be encoded by clients in upper case.
   Implementations MAY wish to employ this encoding to accommodate those
   servers.

   The argument field consists of a variable length character string
   ending with the end of the line, i.e., with the character sequence
   <CRLF>.  The receiver will take no action until this sequence is
   received.

   The syntax for each command is shown with the discussion of that
   command.  Common elements and parameters are shown in section 4.1.2.

   Commands and replies are composed of characters from the ASCII
   character set [1].  When the transport service provides an 8-bit byte
   (octet) transmission channel, each 7-bit character is transmitted
   right justified in an octet with the high order bit cleared to zero.
   More specifically, the unextended SMTP service provides seven bit
   transport only.  An originating SMTP client which has not
   successfully negotiated an appropriate extension with a particular
   server MUST NOT transmit messages with information in the high-order
   bit of octets.  If such messages are transmitted in violation of this
   rule, receiving SMTP servers MAY clear the high-order bit or reject
   the message as invalid.  In general, a relay SMTP SHOULD assume that
   the message content it has received is valid and, assuming that the
   envelope permits doing so, relay it without inspecting that content.
   Of course, if the content is mislabeled and the data path cannot
   accept the actual content, this may result in ultimate delivery of a
   severely garbled message to the recipient.  Delivery SMTP systems MAY
   reject ("bounce") such messages rather than deliver them.  No sending
   SMTP system is permitted to send envelope commands in any character





Klensin                     Standards Track                    [Page 14]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   set other than US-ASCII; receiving systems SHOULD reject such
   commands, normally using "500 syntax error - invalid character"
   replies.

   Eight-bit message content transmission MAY be requested of the server
   by a client using extended SMTP facilities, notably the "8BITMIME"
   extension [20].  8BITMIME SHOULD be supported by SMTP servers.
   However, it MUST not be construed as authorization to transmit
   unrestricted eight bit material.  8BITMIME MUST NOT be requested by
   senders for material with the high bit on that is not in MIME format
   with an appropriate content-transfer encoding; servers MAY reject
   such messages.

   The metalinguistic notation used in this document corresponds to the
   "Augmented BNF" used in other Internet mail system documents.  The
   reader who is not familiar with that syntax should consult the ABNF
   specification [8].  Metalanguage terms used in running text are
   surrounded by pointed brackets (e.g., <CRLF>) for clarity.

3. The SMTP Procedures: An Overview

   This section contains descriptions of the procedures used in SMTP:
   session initiation, the mail transaction, forwarding mail, verifying
   mailbox names and expanding mailing lists, and the opening and
   closing exchanges.  Comments on relaying, a note on mail domains, and
   a discussion of changing roles are included at the end of this
   section.  Several complete scenarios are presented in appendix D.

3.1 Session Initiation

   An SMTP session is initiated when a client opens a connection to a
   server and the server responds with an opening message.

   SMTP server implementations MAY include identification of their
   software and version information in the connection greeting reply
   after the 220 code, a practice that permits more efficient isolation
   and repair of any problems.  Implementations MAY make provision for
   SMTP servers to disable the software and version announcement where
   it causes security concerns.  While some systems also identify their
   contact point for mail problems, this is not a substitute for
   maintaining the required "postmaster" address (see section 4.5.1).

   The SMTP protocol allows a server to formally reject a transaction
   while still allowing the initial connection as follows: a 554
   response MAY be given in the initial connection opening message
   instead of the 220.  A server taking this approach MUST still wait
   for the client to send a QUIT (see section 4.1.1.10) before closing
   the connection and SHOULD respond to any intervening commands with



Klensin                     Standards Track                    [Page 15]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   "503 bad sequence of commands".  Since an attempt to make an SMTP
   connection to such a system is probably in error, a server returning
   a 554 response on connection opening SHOULD provide enough
   information in the reply text to facilitate debugging of the sending
   system.

3.2 Client Initiation

   Once the server has sent the welcoming message and the client has
   received it, the client normally sends the EHLO command to the
   server, indicating the client's identity.  In addition to opening the
   session, use of EHLO indicates that the client is able to process
   service extensions and requests that the server provide a list of the
   extensions it supports.  Older SMTP systems which are unable to
   support service extensions and contemporary clients which do not
   require service extensions in the mail session being initiated, MAY
   use HELO instead of EHLO.  Servers MUST NOT return the extended
   EHLO-style response to a HELO command.  For a particular connection
   attempt, if the server returns a "command not recognized" response to
   EHLO, the client SHOULD be able to fall back and send HELO.

   In the EHLO command the host sending the command identifies itself;
   the command may be interpreted as saying "Hello, I am <domain>" (and,
   in the case of EHLO, "and I support service extension requests").

3.3 Mail Transactions

   There are three steps to SMTP mail transactions.  The transaction
   starts with a MAIL command which gives the sender identification.
   (In general, the MAIL command may be sent only when no mail
   transaction is in progress; see section 4.1.4.)  A series of one or
   more RCPT commands follows giving the receiver information.  Then a
   DATA command initiates transfer of the mail data and is terminated by
   the "end of mail" data indicator, which also confirms the
   transaction.

   The first step in the procedure is the MAIL command.

      MAIL FROM:<reverse-path> [SP <mail-parameters> ] <CRLF>

   This command tells the SMTP-receiver that a new mail transaction is
   starting and to reset all its state tables and buffers, including any
   recipients or mail data.  The <reverse-path> portion of the first or
   only argument contains the source mailbox (between "<" and ">"
   brackets), which can be used to report errors (see section 4.2 for a
   discussion of error reporting).  If accepted, the SMTP server returns
   a 250 OK reply.  If the mailbox specification is not acceptable for
   some reason, the server MUST return a reply indicating whether the



Klensin                     Standards Track                    [Page 16]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   failure is permanent (i.e., will occur again if the client tries to
   send the same address again) or temporary (i.e., the address might be
   accepted if the client tries again later).  Despite the apparent
   scope of this requirement, there are circumstances in which the
   acceptability of the reverse-path may not be determined until one or
   more forward-paths (in RCPT commands) can be examined.  In those
   cases, the server MAY reasonably accept the reverse-path (with a 250
   reply) and then report problems after the forward-paths are received
   and examined.  Normally, failures produce 550 or 553 replies.

   Historically, the <reverse-path> can contain more than just a
   mailbox, however, contemporary systems SHOULD NOT use source routing
   (see appendix C).

   The optional <mail-parameters> are associated with negotiated SMTP
   service extensions (see section 2.2).

   The second step in the procedure is the RCPT command.

      RCPT TO:<forward-path> [ SP <rcpt-parameters> ] <CRLF>

   The first or only argument to this command includes a forward-path
   (normally a mailbox and domain, always surrounded by "<" and ">"
   brackets) identifying one recipient.  If accepted, the SMTP server
   returns a 250 OK reply and stores the forward-path.  If the recipient
   is known not to be a deliverable address, the SMTP server returns a
   550 reply, typically with a string such as "no such user - " and the
   mailbox name (other circumstances and reply codes are possible).
   This step of the procedure can be repeated any number of times.

   The <forward-path> can contain more than just a mailbox.
   Historically, the <forward-path> can be a source routing list of
   hosts and the destination mailbox, however, contemporary SMTP clients
   SHOULD NOT utilize source routes (see appendix C).  Servers MUST be
   prepared to encounter a list of source routes in the forward path,
   but SHOULD ignore the routes or MAY decline to support the relaying
   they imply.  Similarly, servers MAY decline to accept mail that is
   destined for other hosts or systems.  These restrictions make a
   server useless as a relay for clients that do not support full SMTP
   functionality.  Consequently, restricted-capability clients MUST NOT
   assume that any SMTP server on the Internet can be used as their mail
   processing (relaying) site.  If a RCPT command appears without a
   previous MAIL command, the server MUST return a 503 "Bad sequence of
   commands" response.  The optional <rcpt-parameters> are associated
   with negotiated SMTP service extensions (see section 2.2).

   The third step in the procedure is the DATA command (or some
   alternative specified in a service extension).



Klensin                     Standards Track                    [Page 17]

RFC 2821             Simple Mail Transfer Protocol            April 2001


      DATA <CRLF>

   If accepted, the SMTP server returns a 354 Intermediate reply and
   considers all succeeding lines up to but not including the end of
   mail data indicator to be the message text.  When the end of text is
   successfully received and stored the SMTP-receiver sends a 250 OK
   reply.

   Since the mail data is sent on the transmission channel, the end of
   mail data must be indicated so that the command and reply dialog can
   be resumed.  SMTP indicates the end of the mail data by sending a
   line containing only a "." (period or full stop).  A transparency
   procedure is used to prevent this from interfering with the user's
   text (see section 4.5.2).

   The end of mail data indicator also confirms the mail transaction and
   tells the SMTP server to now process the stored recipients and mail
   data.  If accepted, the SMTP server returns a 250 OK reply.  The DATA
   command can fail at only two points in the protocol exchange:

   -  If there was no MAIL, or no RCPT, command, or all such commands
      were rejected, the server MAY return a "command out of sequence"
      (503) or "no valid recipients" (554) reply in response to the DATA
      command.  If one of those replies (or any other 5yz reply) is
      received, the client MUST NOT send the message data; more
      generally, message data MUST NOT be sent unless a 354 reply is
      received.

   -  If the verb is initially accepted and the 354 reply issued, the
      DATA command should fail only if the mail transaction was
      incomplete (for example, no recipients), or if resources were
      unavailable (including, of course, the server unexpectedly
      becoming unavailable), or if the server determines that the
      message should be rejected for policy or other reasons.

   However, in practice, some servers do not perform recipient
   verification until after the message text is received.  These servers
   SHOULD treat a failure for one or more recipients as a "subsequent
   failure" and return a mail message as discussed in section 6.  Using
   a "550 mailbox not found" (or equivalent) reply code after the data
   are accepted makes it difficult or impossible for the client to
   determine which recipients failed.

   When RFC 822 format [7, 32] is being used, the mail data include the
   memo header items such as Date, Subject, To, Cc, From.  Server SMTP
   systems SHOULD NOT reject messages based on perceived defects in the
   RFC 822 or MIME [12] message header or message body.  In particular,




Klensin                     Standards Track                    [Page 18]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   they MUST NOT reject messages in which the numbers of Resent-fields
   do not match or Resent-to appears without Resent-from and/or Resent-
   date.

   Mail transaction commands MUST be used in the order discussed above.

3.4 Forwarding for Address Correction or Updating

   Forwarding support is most often required to consolidate and simplify
   addresses within, or relative to, some enterprise and less frequently
   to establish addresses to link a person's prior address with current
   one.  Silent forwarding of messages (without server notification to
   the sender), for security or non-disclosure purposes, is common in
   the contemporary Internet.

   In both the enterprise and the "new address" cases, information
   hiding (and sometimes security) considerations argue against exposure
   of the "final" address through the SMTP protocol as a side-effect of
   the forwarding activity.  This may be especially important when the
   final address may not even be reachable by the sender.  Consequently,
   the "forwarding" mechanisms described in section 3.2 of RFC 821, and
   especially the 251 (corrected destination) and 551 reply codes from
   RCPT must be evaluated carefully by implementers and, when they are
   available, by those configuring systems.

   In particular:

   *  Servers MAY forward messages when they are aware of an address
      change.  When they do so, they MAY either provide address-updating
      information with a 251 code, or may forward "silently" and return
      a 250 code.  But, if a 251 code is used, they MUST NOT assume that
      the client will actually update address information or even return
      that information to the user.

   Alternately,

   *  Servers MAY reject or bounce messages when they are not
      deliverable when addressed.  When they do so, they MAY either
      provide address-updating information with a 551 code, or may
      reject the message as undeliverable with a 550 code and no
      address-specific information.  But, if a 551 code is used, they
      MUST NOT assume that the client will actually update address
      information or even return that information to the user.

   SMTP server implementations that support the 251 and/or 551 reply
   codes are strongly encouraged to provide configuration mechanisms so
   that sites which conclude that they would undesirably disclose
   information can disable or restrict their use.



Klensin                     Standards Track                    [Page 19]

RFC 2821             Simple Mail Transfer Protocol            April 2001


3.5 Commands for Debugging Addresses

3.5.1 Overview

   SMTP provides commands to verify a user name or obtain the content of
   a mailing list.  This is done with the VRFY and EXPN commands, which
   have character string arguments.  Implementations SHOULD support VRFY
   and EXPN (however, see section 3.5.2 and 7.3).

   For the VRFY command, the string is a user name or a user name and
   domain (see below).  If a normal (i.e., 250) response is returned,
   the response MAY include the full name of the user and MUST include
   the mailbox of the user.  It MUST be in either of the following
   forms:

      User Name <local-part@domain>
      local-part@domain

   When a name that is the argument to VRFY could identify more than one
   mailbox, the server MAY either note the ambiguity or identify the
   alternatives.  In other words, any of the following are legitimate
   response to VRFY:

      553 User ambiguous

   or

      553- Ambiguous;  Possibilities are
      553-Joe Smith <jsmith@foo.com>
      553-Harry Smith <hsmith@foo.com>
      553 Melvin Smith <dweep@foo.com>

   or

      553-Ambiguous;  Possibilities
      553- <jsmith@foo.com>
      553- <hsmith@foo.com>
      553 <dweep@foo.com>

   Under normal circumstances, a client receiving a 553 reply would be
   expected to expose the result to the user.  Use of exactly the forms
   given, and the "user ambiguous" or "ambiguous" keywords, possibly
   supplemented by extended reply codes such as those described in [34],
   will facilitate automated translation into other languages as needed.
   Of course, a client that was highly automated or that was operating
   in another language than English, might choose to try to translate
   the response, to return some other indication to the user than the




Klensin                     Standards Track                    [Page 20]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   literal text of the reply, or to take some automated action such as
   consulting a directory service for additional information before
   reporting to the user.

   For the EXPN command, the string identifies a mailing list, and the
   successful (i.e., 250) multiline response MAY include the full name
   of the users and MUST give the mailboxes on the mailing list.

   In some hosts the distinction between a mailing list and an alias for
   a single mailbox is a bit fuzzy, since a common data structure may
   hold both types of entries, and it is possible to have mailing lists
   containing only one mailbox.  If a request is made to apply VRFY to a
   mailing list, a positive response MAY be given if a message so
   addressed would be delivered to everyone on the list, otherwise an
   error SHOULD be reported (e.g., "550 That is a mailing list, not a
   user" or "252 Unable to verify members of mailing list").  If a
   request is made to expand a user name, the server MAY return a
   positive response consisting of a list containing one name, or an
   error MAY be reported (e.g., "550 That is a user name, not a mailing
   list").

   In the case of a successful multiline reply (normal for EXPN) exactly
   one mailbox is to be specified on each line of the reply.  The case
   of an ambiguous request is discussed above.

   "User name" is a fuzzy term and has been used deliberately.  An
   implementation of the VRFY or EXPN commands MUST include at least
   recognition of local mailboxes as "user names".  However, since
   current Internet practice often results in a single host handling
   mail for multiple domains, hosts, especially hosts that provide this
   functionality, SHOULD accept the "local-part@domain" form as a "user
   name"; hosts MAY also choose to recognize other strings as "user
   names".

   The case of expanding a mailbox list requires a multiline reply, such
   as:

      C: EXPN Example-People
      S: 250-Jon Postel <Postel@isi.edu>
      S: 250-Fred Fonebone <Fonebone@physics.foo-u.edu>
      S: 250 Sam Q. Smith <SQSmith@specific.generic.com>

   or

      C: EXPN Executive-Washroom-List
      S: 550 Access Denied to You.





Klensin                     Standards Track                    [Page 21]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   The character string arguments of the VRFY and EXPN commands cannot
   be further restricted due to the variety of implementations of the
   user name and mailbox list concepts.  On some systems it may be
   appropriate for the argument of the EXPN command to be a file name
   for a file containing a mailing list, but again there are a variety
   of file naming conventions in the Internet.  Similarly, historical
   variations in what is returned by these commands are such that the
   response SHOULD be interpreted very carefully, if at all, and SHOULD
   generally only be used for diagnostic purposes.

3.5.2 VRFY Normal Response

   When normal (2yz or 551) responses are returned from a VRFY or EXPN
   request, the reply normally includes the mailbox name, i.e.,
   "<local-part@domain>", where "domain" is a fully qualified domain
   name, MUST appear in the syntax.  In circumstances exceptional enough
   to justify violating the intent of this specification, free-form text
   MAY be returned.  In order to facilitate parsing by both computers
   and people, addresses SHOULD appear in pointed brackets.  When
   addresses, rather than free-form debugging information, are returned,
   EXPN and VRFY MUST return only valid domain addresses that are usable
   in SMTP RCPT commands.  Consequently, if an address implies delivery
   to a program or other system, the mailbox name used to reach that
   target MUST be given.  Paths (explicit source routes) MUST NOT be
   returned by VRFY or EXPN.

   Server implementations SHOULD support both VRFY and EXPN.  For
   security reasons, implementations MAY provide local installations a
   way to disable either or both of these commands through configuration
   options or the equivalent.  When these commands are supported, they
   are not required to work across relays when relaying is supported.
   Since they were both optional in RFC 821, they MUST be listed as
   service extensions in an EHLO response, if they are supported.

3.5.3 Meaning of VRFY or EXPN Success Response

   A server MUST NOT return a 250 code in response to a VRFY or EXPN
   command unless it has actually verified the address.  In particular,
   a server MUST NOT return 250 if all it has done is to verify that the
   syntax given is valid.  In that case, 502 (Command not implemented)
   or 500 (Syntax error, command unrecognized) SHOULD be returned.  As
   stated elsewhere, implementation (in the sense of actually validating
   addresses and returning information) of VRFY and EXPN are strongly
   recommended.  Hence, implementations that return 500 or 502 for VRFY
   are not in full compliance with this specification.






Klensin                     Standards Track                    [Page 22]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   There may be circumstances where an address appears to be valid but
   cannot reasonably be verified in real time, particularly when a
   server is acting as a mail exchanger for another server or domain.
   "Apparent validity" in this case would normally involve at least
   syntax checking and might involve verification that any domains
   specified were ones to which the host expected to be able to relay
   mail.  In these situations, reply code 252 SHOULD be returned.  These
   cases parallel the discussion of RCPT verification discussed in
   section 2.1.  Similarly, the discussion in section 3.4 applies to the
   use of reply codes 251 and 551 with VRFY (and EXPN) to indicate
   addresses that are recognized but that would be forwarded or bounced
   were mail received for them.  Implementations generally SHOULD be
   more aggressive about address verification in the case of VRFY than
   in the case of RCPT, even if it takes a little longer to do so.

3.5.4 Semantics and Applications of EXPN

   EXPN is often very useful in debugging and understanding problems
   with mailing lists and multiple-target-address aliases.  Some systems
   have attempted to use source expansion of mailing lists as a means of
   eliminating duplicates.  The propagation of aliasing systems with
   mail on the Internet, for hosts (typically with MX and CNAME DNS
   records), for mailboxes (various types of local host aliases), and in
   various proxying arrangements, has made it nearly impossible for
   these strategies to work consistently, and mail systems SHOULD NOT
   attempt them.

3.6 Domains

   Only resolvable, fully-qualified, domain names (FQDNs) are permitted
   when domain names are used in SMTP.  In other words, names that can
   be resolved to MX RRs or A RRs (as discussed in section 5) are
   permitted, as are CNAME RRs whose targets can be resolved, in turn,
   to MX or A RRs.  Local nicknames or unqualified names MUST NOT be
   used.  There are two exceptions to the rule requiring FQDNs:

   -  The domain name given in the EHLO command MUST BE either a primary
      host name (a domain name that resolves to an A RR) or, if the host
      has no name, an address literal as described in section 4.1.1.1.

   -  The reserved mailbox name "postmaster" may be used in a RCPT
      command without domain qualification (see section 4.1.1.3) and
      MUST be accepted if so used.








Klensin                     Standards Track                    [Page 23]

RFC 2821             Simple Mail Transfer Protocol            April 2001


3.7 Relaying

   In general, the availability of Mail eXchanger records in the domain
   name system [22, 27] makes the use of explicit source routes in the
   Internet mail system unnecessary.  Many historical problems with
   their interpretation have made their use undesirable.  SMTP clients
   SHOULD NOT generate explicit source routes except under unusual
   circumstances.  SMTP servers MAY decline to act as mail relays or to
   accept addresses that specify source routes.  When route information
   is encountered, SMTP servers are also permitted to ignore the route
   information and simply send to the final destination specified as the
   last element in the route and SHOULD do so.  There has been an
   invalid practice of using names that do not appear in the DNS as
   destination names, with the senders counting on the intermediate
   hosts specified in source routing to resolve any problems.  If source
   routes are stripped, this practice will cause failures.  This is one
   of several reasons why SMTP clients MUST NOT generate invalid source
   routes or depend on serial resolution of names.

   When source routes are not used, the process described in RFC 821 for
   constructing a reverse-path from the forward-path is not applicable
   and the reverse-path at the time of delivery will simply be the
   address that appeared in the MAIL command.

   A relay SMTP server is usually the target of a DNS MX record that
   designates it, rather than the final delivery system.  The relay
   server may accept or reject the task of relaying the mail in the same
   way it accepts or rejects mail for a local user.  If it accepts the
   task, it then becomes an SMTP client, establishes a transmission
   channel to the next SMTP server specified in the DNS (according to
   the rules in section 5), and sends it the mail.  If it declines to
   relay mail to a particular address for policy reasons, a 550 response
   SHOULD be returned.

   Many mail-sending clients exist, especially in conjunction with
   facilities that receive mail via POP3 or IMAP, that have limited
   capability to support some of the requirements of this specification,
   such as the ability to queue messages for subsequent delivery
   attempts.  For these clients, it is common practice to make private
   arrangements to send all messages to a single server for processing
   and subsequent distribution.  SMTP, as specified here, is not ideally
   suited for this role, and work is underway on standardized mail
   submission protocols that might eventually supercede the current
   practices.  In any event, because these arrangements are private and
   fall outside the scope of this specification, they are not described
   here.





Klensin                     Standards Track                    [Page 24]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   It is important to note that MX records can point to SMTP servers
   which act as gateways into other environments, not just SMTP relays
   and final delivery systems; see sections 3.8 and 5.

   If an SMTP server has accepted the task of relaying the mail and
   later finds that the destination is incorrect or that the mail cannot
   be delivered for some other reason, then it MUST construct an
   "undeliverable mail" notification message and send it to the
   originator of the undeliverable mail (as indicated by the reverse-
   path).  Formats specified for non-delivery reports by other standards
   (see, for example, [24, 25]) SHOULD be used if possible.

   This notification message must be from the SMTP server at the relay
   host or the host that first determines that delivery cannot be
   accomplished.  Of course, SMTP servers MUST NOT send notification
   messages about problems transporting notification messages.  One way
   to prevent loops in error reporting is to specify a null reverse-path
   in the MAIL command of a notification message.  When such a message
   is transmitted the reverse-path MUST be set to null (see section
   4.5.5 for additional discussion).  A MAIL command with a null
   reverse-path appears as follows:

      MAIL FROM:<>

   As discussed in section 2.4.1, a relay SMTP has no need to inspect or
   act upon the headers or body of the message data and MUST NOT do so
   except to add its own "Received:" header (section 4.4) and,
   optionally, to attempt to detect looping in the mail system (see
   section 6.2).

3.8 Mail Gatewaying

   While the relay function discussed above operates within the Internet
   SMTP transport service environment, MX records or various forms of
   explicit routing may require that an intermediate SMTP server perform
   a translation function between one transport service and another.  As
   discussed in section 2.3.8, when such a system is at the boundary
   between two transport service environments, we refer to it as a
   "gateway" or "gateway SMTP".

   Gatewaying mail between different mail environments, such as
   different mail formats and protocols, is complex and does not easily
   yield to standardization.  However, some general requirements may be
   given for a gateway between the Internet and another mail
   environment.






Klensin                     Standards Track                    [Page 25]

RFC 2821             Simple Mail Transfer Protocol            April 2001


3.8.1 Header Fields in Gatewaying

   Header fields MAY be rewritten when necessary as messages are
   gatewayed across mail environment boundaries.  This may involve
   inspecting the message body or interpreting the local-part of the
   destination address in spite of the prohibitions in section 2.4.1.

   Other mail systems gatewayed to the Internet often use a subset of
   RFC 822 headers or provide similar functionality with a different
   syntax, but some of these mail systems do not have an equivalent to
   the SMTP envelope.  Therefore, when a message leaves the Internet
   environment, it may be necessary to fold the SMTP envelope
   information into the message header.  A possible solution would be to
   create new header fields to carry the envelope information (e.g.,
   "X-SMTP-MAIL:"  and "X-SMTP-RCPT:"); however, this would require
   changes in mail programs in foreign environments and might risk
   disclosure of private information (see section 7.2).

3.8.2 Received Lines in Gatewaying

   When forwarding a message into or out of the Internet environment, a
   gateway MUST prepend a Received: line, but it MUST NOT alter in any
   way a Received: line that is already in the header.

   "Received:" fields of messages originating from other environments
   may not conform exactly to this specification.  However, the most
   important use of Received: lines is for debugging mail faults, and
   this debugging can be severely hampered by well-meaning gateways that
   try to "fix" a Received: line.  As another consequence of trace
   fields arising in non-SMTP environments, receiving systems MUST NOT
   reject mail based on the format of a trace field and SHOULD be
   extremely robust in the light of unexpected information or formats in
   those fields.

   The gateway SHOULD indicate the environment and protocol in the "via"
   clauses of Received field(s) that it supplies.

3.8.3 Addresses in Gatewaying

   From the Internet side, the gateway SHOULD accept all valid address
   formats in SMTP commands and in RFC 822 headers, and all valid RFC
   822 messages.  Addresses and headers generated by gateways MUST
   conform to applicable Internet standards (including this one and RFC
   822).  Gateways are, of course, subject to the same rules for
   handling source routes as those described for other SMTP systems in
   section 3.3.





Klensin                     Standards Track                    [Page 26]

RFC 2821             Simple Mail Transfer Protocol            April 2001


3.8.4 Other Header Fields in Gatewaying

   The gateway MUST ensure that all header fields of a message that it
   forwards into the Internet mail environment meet the requirements for
   Internet mail.  In particular, all addresses in "From:", "To:",
   "Cc:", etc., fields MUST be transformed (if necessary) to satisfy RFC
   822 syntax, MUST reference only fully-qualified domain names, and
   MUST be effective and useful for sending replies.  The translation
   algorithm used to convert mail from the Internet protocols to another
   environment's protocol SHOULD ensure that error messages from the
   foreign mail environment are delivered to the return path from the
   SMTP envelope, not to the sender listed in the "From:" field (or
   other fields) of the RFC 822 message.

3.8.5 Envelopes in Gatewaying

   Similarly, when forwarding a message from another environment into
   the Internet, the gateway SHOULD set the envelope return path in
   accordance with an error message return address, if supplied by the
   foreign environment.  If the foreign environment has no equivalent
   concept, the gateway must select and use a best approximation, with
   the message originator's address as the default of last resort.

3.9 Terminating Sessions and Connections

   An SMTP connection is terminated when the client sends a QUIT
   command.  The server responds with a positive reply code, after which
   it closes the connection.

   An SMTP server MUST NOT intentionally close the connection except:

   -  After receiving a QUIT command and responding with a 221 reply.

   -  After detecting the need to shut down the SMTP service and
      returning a 421 response code.  This response code can be issued
      after the server receives any command or, if necessary,
      asynchronously from command receipt (on the assumption that the
      client will receive it after the next command is issued).

   In particular, a server that closes connections in response to
   commands that are not understood is in violation of this
   specification.  Servers are expected to be tolerant of unknown
   commands, issuing a 500 reply and awaiting further instructions from
   the client.







Klensin                     Standards Track                    [Page 27]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   An SMTP server which is forcibly shut down via external means SHOULD
   attempt to send a line containing a 421 response code to the SMTP
   client before exiting.  The SMTP client will normally read the 421
   response code after sending its next command.

   SMTP clients that experience a connection close, reset, or other
   communications failure due to circumstances not under their control
   (in violation of the intent of this specification but sometimes
   unavoidable) SHOULD, to maintain the robustness of the mail system,
   treat the mail transaction as if a 451 response had been received and
   act accordingly.

3.10 Mailing Lists and Aliases

   An SMTP-capable host SHOULD support both the alias and the list
   models of address expansion for multiple delivery.  When a message is
   delivered or forwarded to each address of an expanded list form, the
   return address in the envelope ("MAIL FROM:") MUST be changed to be
   the address of a person or other entity who administers the list.
   However, in this case, the message header [32] MUST be left
   unchanged; in particular, the "From" field of the message header is
   unaffected.

   An important mail facility is a mechanism for multi-destination
   delivery of a single message, by transforming (or "expanding" or
   "exploding") a pseudo-mailbox address into a list of destination
   mailbox addresses.  When a message is sent to such a pseudo-mailbox
   (sometimes called an "exploder"), copies are forwarded or
   redistributed to each mailbox in the expanded list.  Servers SHOULD
   simply utilize the addresses on the list; application of heuristics
   or other matching rules to eliminate some addresses, such as that of
   the originator, is strongly discouraged.  We classify such a pseudo-
   mailbox as an "alias" or a "list", depending upon the expansion
   rules.

3.10.1 Alias

   To expand an alias, the recipient mailer simply replaces the pseudo-
   mailbox address in the envelope with each of the expanded addresses
   in turn; the rest of the envelope and the message body are left
   unchanged.  The message is then delivered or forwarded to each
   expanded address.

3.10.2 List

   A mailing list may be said to operate by "redistribution" rather than
   by "forwarding".  To expand a list, the recipient mailer replaces the
   pseudo-mailbox address in the envelope with all of the expanded



Klensin                     Standards Track                    [Page 28]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   addresses.  The return address in the envelope is changed so that all
   error messages generated by the final deliveries will be returned to
   a list administrator, not to the message originator, who generally
   has no control over the contents of the list and will typically find
   error messages annoying.

4. The SMTP Specifications

4.1 SMTP Commands

4.1.1 Command Semantics and Syntax

   The SMTP commands define the mail transfer or the mail system
   function requested by the user.  SMTP commands are character strings
   terminated by <CRLF>.  The commands themselves are alphabetic
   characters terminated by <SP> if parameters follow and <CRLF>
   otherwise.  (In the interest of improved interoperability, SMTP
   receivers are encouraged to tolerate trailing white space before the
   terminating <CRLF>.)  The syntax of the local part of a mailbox must
   conform to receiver site conventions and the syntax specified in
   section 4.1.2.  The SMTP commands are discussed below.  The SMTP
   replies are discussed in section 4.2.

   A mail transaction involves several data objects which are
   communicated as arguments to different commands.  The reverse-path is
   the argument of the MAIL command, the forward-path is the argument of
   the RCPT command, and the mail data is the argument of the DATA
   command.  These arguments or data objects must be transmitted and
   held pending the confirmation communicated by the end of mail data
   indication which finalizes the transaction.  The model for this is
   that distinct buffers are provided to hold the types of data objects,
   that is, there is a reverse-path buffer, a forward-path buffer, and a
   mail data buffer.  Specific commands cause information to be appended
   to a specific buffer, or cause one or more buffers to be cleared.

   Several commands (RSET, DATA, QUIT) are specified as not permitting
   parameters.  In the absence of specific extensions offered by the
   server and accepted by the client, clients MUST NOT send such
   parameters and servers SHOULD reject commands containing them as
   having invalid syntax.

4.1.1.1  Extended HELLO (EHLO) or HELLO (HELO)

   These commands are used to identify the SMTP client to the SMTP
   server.  The argument field contains the fully-qualified domain name
   of the SMTP client if one is available.  In situations in which the
   SMTP client system does not have a meaningful domain name (e.g., when
   its address is dynamically allocated and no reverse mapping record is



Klensin                     Standards Track                    [Page 29]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   available), the client SHOULD send an address literal (see section
   4.1.3), optionally followed by information that will help to identify
   the client system.  y The SMTP server identifies itself to the SMTP
   client in the connection greeting reply and in the response to this
   command.

   A client SMTP SHOULD start an SMTP session by issuing the EHLO
   command.  If the SMTP server supports the SMTP service extensions it
   will give a successful response, a failure response, or an error
   response.  If the SMTP server, in violation of this specification,
   does not support any SMTP service extensions it will generate an
   error response.  Older client SMTP systems MAY, as discussed above,
   use HELO (as specified in RFC 821) instead of EHLO, and servers MUST
   support the HELO command and reply properly to it.  In any event, a
   client MUST issue HELO or EHLO before starting a mail transaction.

   These commands, and a "250 OK" reply to one of them, confirm that
   both the SMTP client and the SMTP server are in the initial state,
   that is, there is no transaction in progress and all state tables and
   buffers are cleared.

   Syntax:

      ehlo            = "EHLO" SP Domain CRLF
      helo            = "HELO" SP Domain CRLF

   Normally, the response to EHLO will be a multiline reply.  Each line
   of the response contains a keyword and, optionally, one or more
   parameters.  Following the normal syntax for multiline replies, these
   keyworks follow the code (250) and a hyphen for all but the last
   line, and the code and a space for the last line.  The syntax for a
   positive response, using the ABNF notation and terminal symbols of
   [8], is:

      ehlo-ok-rsp  =    ( "250"    domain [ SP ehlo-greet ] CRLF )
                   / (    "250-"   domain [ SP ehlo-greet ] CRLF
                       *( "250-"   ehlo-line                CRLF )
                          "250"    SP ehlo-line             CRLF  )

      ehlo-greet   = 1*(%d0-9 / %d11-12 / %d14-127)
                   ; string of any characters other than CR or LF

      ehlo-line    = ehlo-keyword *( SP ehlo-param )

      ehlo-keyword = (ALPHA / DIGIT) *(ALPHA / DIGIT / "-")
                   ; additional syntax of ehlo-params depends on
                   ; ehlo-keyword




Klensin                     Standards Track                    [Page 30]

RFC 2821             Simple Mail Transfer Protocol            April 2001


      ehlo-param   = 1*(%d33-127)
                   ; any CHAR excluding <SP> and all
                   ; control characters (US-ASCII 0-31 inclusive)

   Although EHLO keywords may be specified in upper, lower, or mixed
   case, they MUST always be recognized and processed in a case-
   insensitive manner.  This is simply an extension of practices
   specified in RFC 821 and section 2.4.1.

4.1.1.2 MAIL (MAIL)

   This command is used to initiate a mail transaction in which the mail
   data is delivered to an SMTP server which may, in turn, deliver it to
   one or more mailboxes or pass it on to another system (possibly using
   SMTP).  The argument field contains a reverse-path and may contain
   optional parameters.  In general, the MAIL command may be sent only
   when no mail transaction is in progress, see section 4.1.4.

   The reverse-path consists of the sender mailbox.  Historically, that
   mailbox might optionally have been preceded by a list of hosts, but
   that behavior is now deprecated (see appendix C).  In some types of
   reporting messages for which a reply is likely to cause a mail loop
   (for example, mail delivery and nondelivery notifications), the
   reverse-path may be null (see section 3.7).

   This command clears the reverse-path buffer, the forward-path buffer,
   and the mail data buffer; and inserts the reverse-path information
   from this command into the reverse-path buffer.

   If service extensions were negotiated, the MAIL command may also
   carry parameters associated with a particular service extension.

   Syntax:

      "MAIL FROM:" ("<>" / Reverse-Path)
                       [SP Mail-parameters] CRLF

4.1.1.3 RECIPIENT (RCPT)

   This command is used to identify an individual recipient of the mail
   data; multiple recipients are specified by multiple use of this
   command.  The argument field contains a forward-path and may contain
   optional parameters.

   The forward-path normally consists of the required destination
   mailbox.  Sending systems SHOULD not generate the optional list of
   hosts known as a source route.  Receiving systems MUST recognize




Klensin                     Standards Track                    [Page 31]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   source route syntax but SHOULD strip off the source route
   specification and utilize the domain name associated with the mailbox
   as if the source route had not been provided.

   Similarly, relay hosts SHOULD strip or ignore source routes, and
   names MUST NOT be copied into the reverse-path.  When mail reaches
   its ultimate destination (the forward-path contains only a
   destination mailbox), the SMTP server inserts it into the destination
   mailbox in accordance with its host mail conventions.

   For example, mail received at relay host xyz.com with envelope
   commands

      MAIL FROM:<userx@y.foo.org>
      RCPT TO:<@hosta.int,@jkl.org:userc@d.bar.org>

   will normally be sent directly on to host d.bar.org with envelope
   commands

      MAIL FROM:<userx@y.foo.org>
      RCPT TO:<userc@d.bar.org>

   As provided in appendix C, xyz.com MAY also choose to relay the
   message to hosta.int, using the envelope commands

      MAIL FROM:<userx@y.foo.org>
      RCPT TO:<@hosta.int,@jkl.org:userc@d.bar.org>

   or to jkl.org, using the envelope commands

      MAIL FROM:<userx@y.foo.org>
      RCPT TO:<@jkl.org:userc@d.bar.org>

   Of course, since hosts are not required to relay mail at all, xyz.com
   may also reject the message entirely when the RCPT command is
   received, using a 550 code (since this is a "policy reason").

   If service extensions were negotiated, the RCPT command may also
   carry parameters associated with a particular service extension
   offered by the server.  The client MUST NOT transmit parameters other
   than those associated with a service extension offered by the server
   in its EHLO response.

Syntax:
   "RCPT TO:" ("<Postmaster@" domain ">" / "<Postmaster>" / Forward-Path)
                    [SP Rcpt-parameters] CRLF





Klensin                     Standards Track                    [Page 32]

RFC 2821             Simple Mail Transfer Protocol            April 2001


4.1.1.4 DATA (DATA)

   The receiver normally sends a 354 response to DATA, and then treats
   the lines (strings ending in <CRLF> sequences, as described in
   section 2.3.7) following the command as mail data from the sender.
   This command causes the mail data to be appended to the mail data
   buffer.  The mail data may contain any of the 128 ASCII character
   codes, although experience has indicated that use of control
   characters other than SP, HT, CR, and LF may cause problems and
   SHOULD be avoided when possible.

   The mail data is terminated by a line containing only a period, that
   is, the character sequence "<CRLF>.<CRLF>" (see section 4.5.2).  This
   is the end of mail data indication.  Note that the first <CRLF> of
   this terminating sequence is also the <CRLF> that ends the final line
   of the data (message text) or, if there was no data, ends the DATA
   command itself.  An extra <CRLF> MUST NOT be added, as that would
   cause an empty line to be added to the message.  The only exception
   to this rule would arise if the message body were passed to the
   originating SMTP-sender with a final "line" that did not end in
   <CRLF>; in that case, the originating SMTP system MUST either reject
   the message as invalid or add <CRLF> in order to have the receiving
   SMTP server recognize the "end of data" condition.

   The custom of accepting lines ending only in <LF>, as a concession to
   non-conforming behavior on the part of some UNIX systems, has proven
   to cause more interoperability problems than it solves, and SMTP
   server systems MUST NOT do this, even in the name of improved
   robustness.  In particular, the sequence "<LF>.<LF>" (bare line
   feeds, without carriage returns) MUST NOT be treated as equivalent to
   <CRLF>.<CRLF> as the end of mail data indication.

   Receipt of the end of mail data indication requires the server to
   process the stored mail transaction information.  This processing
   consumes the information in the reverse-path buffer, the forward-path
   buffer, and the mail data buffer, and on the completion of this
   command these buffers are cleared.  If the processing is successful,
   the receiver MUST send an OK reply.  If the processing fails the
   receiver MUST send a failure reply.  The SMTP model does not allow
   for partial failures at this point: either the message is accepted by
   the server for delivery and a positive response is returned or it is
   not accepted and a failure reply is returned.  In sending a positive
   completion reply to the end of data indication, the receiver takes
   full responsibility for the message (see section 6.1).  Errors that
   are diagnosed subsequently MUST be reported in a mail message, as
   discussed in section 4.4.





Klensin                     Standards Track                    [Page 33]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   When the SMTP server accepts a message either for relaying or for
   final delivery, it inserts a trace record (also referred to
   interchangeably as a "time stamp line" or "Received" line) at the top
   of the mail data.  This trace record indicates the identity of the
   host that sent the message, the identity of the host that received
   the message (and is inserting this time stamp), and the date and time
   the message was received.  Relayed messages will have multiple time
   stamp lines.  Details for formation of these lines, including their
   syntax, is specified in section 4.4.

   Additional discussion about the operation of the DATA command appears
   in section 3.3.

   Syntax:
      "DATA" CRLF

4.1.1.5 RESET (RSET)

   This command specifies that the current mail transaction will be
   aborted.  Any stored sender, recipients, and mail data MUST be
   discarded, and all buffers and state tables cleared.  The receiver
   MUST send a "250 OK" reply to a RSET command with no arguments.  A
   reset command may be issued by the client at any time.  It is
   effectively equivalent to a NOOP (i.e., if has no effect) if issued
   immediately after EHLO, before EHLO is issued in the session, after
   an end-of-data indicator has been sent and acknowledged, or
   immediately before a QUIT.  An SMTP server MUST NOT close the
   connection as the result of receiving a RSET; that action is reserved
   for QUIT (see section 4.1.1.10).

   Since EHLO implies some additional processing and response by the
   server, RSET will normally be more efficient than reissuing that
   command, even though the formal semantics are the same.

   There are circumstances, contrary to the intent of this
   specification, in which an SMTP server may receive an indication that
   the underlying TCP connection has been closed or reset.  To preserve
   the robustness of the mail system, SMTP servers SHOULD be prepared
   for this condition and SHOULD treat it as if a QUIT had been received
   before the connection disappeared.

   Syntax:
      "RSET" CRLF








Klensin                     Standards Track                    [Page 34]

RFC 2821             Simple Mail Transfer Protocol            April 2001


4.1.1.6 VERIFY (VRFY)

   This command asks the receiver to confirm that the argument
   identifies a user or mailbox.  If it is a user name, information is
   returned as specified in section 3.5.

   This command has no effect on the reverse-path buffer, the forward-
   path buffer, or the mail data buffer.

   Syntax:
      "VRFY" SP String CRLF

4.1.1.7 EXPAND (EXPN)

   This command asks the receiver to confirm that the argument
   identifies a mailing list, and if so, to return the membership of
   that list.  If the command is successful, a reply is returned
   containing information as described in section 3.5.  This reply will
   have multiple lines except in the trivial case of a one-member list.

   This command has no effect on the reverse-path buffer, the forward-
   path buffer, or the mail data buffer and may be issued at any time.

   Syntax:
      "EXPN" SP String CRLF

4.1.1.8 HELP (HELP)

   This command causes the server to send helpful information to the
   client.  The command MAY take an argument (e.g., any command name)
   and return more specific information as a response.

   This command has no effect on the reverse-path buffer, the forward-
   path buffer, or the mail data buffer and may be issued at any time.

   SMTP servers SHOULD support HELP without arguments and MAY support it
   with arguments.

   Syntax:
      "HELP" [ SP String ] CRLF

4.1.1.9 NOOP (NOOP)

   This command does not affect any parameters or previously entered
   commands.  It specifies no action other than that the receiver send
   an OK reply.





Klensin                     Standards Track                    [Page 35]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   This command has no effect on the reverse-path buffer, the forward-
   path buffer, or the mail data buffer and may be issued at any time.
   If a parameter string is specified, servers SHOULD ignore it.

   Syntax:
      "NOOP" [ SP String ] CRLF

4.1.1.10 QUIT (QUIT)

   This command specifies that the receiver MUST send an OK reply, and
   then close the transmission channel.

   The receiver MUST NOT intentionally close the transmission channel
   until it receives and replies to a QUIT command (even if there was an
   error).  The sender MUST NOT intentionally close the transmission
   channel until it sends a QUIT command and SHOULD wait until it
   receives the reply (even if there was an error response to a previous
   command).  If the connection is closed prematurely due to violations
   of the above or system or network failure, the server MUST cancel any
   pending transaction, but not undo any previously completed
   transaction, and generally MUST act as if the command or transaction
   in progress had received a temporary error (i.e., a 4yz response).

   The QUIT command may be issued at any time.

   Syntax:
      "QUIT" CRLF

4.1.2 Command Argument Syntax

   The syntax of the argument fields of the above commands (using the
   syntax specified in [8] where applicable) is given below.  Some of
   the productions given below are used only in conjunction with source
   routes as described in appendix C.  Terminals not defined in this
   document, such as ALPHA, DIGIT, SP, CR, LF, CRLF, are as defined in
   the "core" syntax [8 (section 6)] or in the message format syntax
   [32].

      Reverse-path = Path
      Forward-path = Path
      Path = "<" [ A-d-l ":" ] Mailbox ">"
      A-d-l = At-domain *( "," A-d-l )
            ; Note that this form, the so-called "source route",
            ; MUST BE accepted, SHOULD NOT be generated, and SHOULD be
            ; ignored.
      At-domain = "@" domain
      Mail-parameters = esmtp-param *(SP esmtp-param)
      Rcpt-parameters = esmtp-param *(SP esmtp-param)



Klensin                     Standards Track                    [Page 36]

RFC 2821             Simple Mail Transfer Protocol            April 2001


      esmtp-param     = esmtp-keyword ["=" esmtp-value]
      esmtp-keyword   = (ALPHA / DIGIT) *(ALPHA / DIGIT / "-")
      esmtp-value     = 1*(%d33-60 / %d62-127)
            ; any CHAR excluding "=", SP, and control characters
      Keyword  = Ldh-str
      Argument = Atom
      Domain = (sub-domain 1*("." sub-domain)) / address-literal
      sub-domain = Let-dig [Ldh-str]

      address-literal = "[" IPv4-address-literal /
                            IPv6-address-literal /
                            General-address-literal "]"
            ; See section 4.1.3

      Mailbox = Local-part "@" Domain

      Local-part = Dot-string / Quoted-string
            ; MAY be case-sensitive

      Dot-string = Atom *("." Atom)

      Atom = 1*atext

      Quoted-string = DQUOTE *qcontent DQUOTE

      String = Atom / Quoted-string

   While the above definition for Local-part is relatively permissive,
   for maximum interoperability, a host that expects to receive mail
   SHOULD avoid defining mailboxes where the Local-part requires (or
   uses) the Quoted-string form or where the Local-part is case-
   sensitive.  For any purposes that require generating or comparing
   Local-parts (e.g., to specific mailbox names), all quoted forms MUST
   be treated as equivalent and the sending system SHOULD transmit the
   form that uses the minimum quoting possible.

   Systems MUST NOT define mailboxes in such a way as to require the use
   in SMTP of non-ASCII characters (octets with the high order bit set
   to one) or ASCII "control characters" (decimal value 0-31 and 127).
   These characters MUST NOT be used in MAIL or RCPT commands or other
   commands that require mailbox names.

   Note that the backslash, "\", is a quote character, which is used to
   indicate that the next character is to be used literally (instead of
   its normal interpretation).  For example, "Joe\,Smith" indicates a
   single nine character user field with the comma being the fourth
   character of the field.




Klensin                     Standards Track                    [Page 37]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   To promote interoperability and consistent with long-standing
   guidance about conservative use of the DNS in naming and applications
   (e.g., see section 2.3.1 of the base DNS document, RFC1035 [22]),
   characters outside the set of alphas, digits, and hyphen MUST NOT
   appear in domain name labels for SMTP clients or servers.  In
   particular, the underscore character is not permitted.  SMTP servers
   that receive a command in which invalid character codes have been
   employed, and for which there are no other reasons for rejection,
   MUST reject that command with a 501 response.

4.1.3 Address Literals

   Sometimes a host is not known to the domain name system and
   communication (and, in particular, communication to report and repair
   the error) is blocked.  To bypass this barrier a special literal form
   of the address is allowed as an alternative to a domain name.  For
   IPv4 addresses, this form uses four small decimal integers separated
   by dots and enclosed by brackets such as [123.255.37.2], which
   indicates an (IPv4) Internet Address in sequence-of-octets form.  For
   IPv6 and other forms of addressing that might eventually be
   standardized, the form consists of a standardized "tag" that
   identifies the address syntax, a colon, and the address itself, in a
   format specified as part of the IPv6 standards [17].

   Specifically:

      IPv4-address-literal = Snum 3("." Snum)
      IPv6-address-literal = "IPv6:" IPv6-addr
      General-address-literal = Standardized-tag ":" 1*dcontent
      Standardized-tag = Ldh-str
            ; MUST be specified in a standards-track RFC
            ; and registered with IANA

      Snum = 1*3DIGIT  ; representing a decimal integer
            ; value in the range 0 through 255
      Let-dig = ALPHA / DIGIT
      Ldh-str = *( ALPHA / DIGIT / "-" ) Let-dig

      IPv6-addr = IPv6-full / IPv6-comp / IPv6v4-full / IPv6v4-comp
      IPv6-hex  = 1*4HEXDIG
      IPv6-full = IPv6-hex 7(":" IPv6-hex)
      IPv6-comp = [IPv6-hex *5(":" IPv6-hex)] "::" [IPv6-hex *5(":"
                 IPv6-hex)]
            ; The "::" represents at least 2 16-bit groups of zeros
            ; No more than 6 groups in addition to the "::" may be
            ; present
      IPv6v4-full = IPv6-hex 5(":" IPv6-hex) ":" IPv4-address-literal
      IPv6v4-comp = [IPv6-hex *3(":" IPv6-hex)] "::"



Klensin                     Standards Track                    [Page 38]

RFC 2821             Simple Mail Transfer Protocol            April 2001


                   [IPv6-hex *3(":" IPv6-hex) ":"] IPv4-address-literal
            ; The "::" represents at least 2 16-bit groups of zeros
            ; No more than 4 groups in addition to the "::" and
            ; IPv4-address-literal may be present

4.1.4 Order of Commands

   There are restrictions on the order in which these commands may be
   used.

   A session that will contain mail transactions MUST first be
   initialized by the use of the EHLO command.  An SMTP server SHOULD
   accept commands for non-mail transactions (e.g., VRFY or EXPN)
   without this initialization.

   An EHLO command MAY be issued by a client later in the session.  If
   it is issued after the session begins, the SMTP server MUST clear all
   buffers and reset the state exactly as if a RSET command had been
   issued.  In other words, the sequence of RSET followed immediately by
   EHLO is redundant, but not harmful other than in the performance cost
   of executing unnecessary commands.

   If the EHLO command is not acceptable to the SMTP server, 501, 500,
   or 502 failure replies MUST be returned as appropriate.  The SMTP
   server MUST stay in the same state after transmitting these replies
   that it was in before the EHLO was received.

   The SMTP client MUST, if possible, ensure that the domain parameter
   to the EHLO command is a valid principal host name (not a CNAME or MX
   name) for its host.  If this is not possible (e.g., when the client's
   address is dynamically assigned and the client does not have an
   obvious name), an address literal SHOULD be substituted for the
   domain name and supplemental information provided that will assist in
   identifying the client.

   An SMTP server MAY verify that the domain name parameter in the EHLO
   command actually corresponds to the IP address of the client.
   However, the server MUST NOT refuse to accept a message for this
   reason if the verification fails: the information about verification
   failure is for logging and tracing only.

   The NOOP, HELP, EXPN, VRFY, and RSET commands can be used at any time
   during a session, or without previously initializing a session.  SMTP
   servers SHOULD process these normally (that is, not return a 503
   code) even if no EHLO command has yet been received; clients SHOULD
   open a session with EHLO before sending these commands.





Klensin                     Standards Track                    [Page 39]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   If these rules are followed, the example in RFC 821 that shows "550
   access denied to you" in response to an EXPN command is incorrect
   unless an EHLO command precedes the EXPN or the denial of access is
   based on the client's IP address or other authentication or
   authorization-determining mechanisms.

   The MAIL command (or the obsolete SEND, SOML, or SAML commands)
   begins a mail transaction.  Once started, a mail transaction consists
   of a transaction beginning command, one or more RCPT commands, and a
   DATA command, in that order.  A mail transaction may be aborted by
   the RSET (or a new EHLO) command.  There may be zero or more
   transactions in a session.  MAIL (or SEND, SOML, or SAML) MUST NOT be
   sent if a mail transaction is already open, i.e., it should be sent
   only if no mail transaction had been started in the session, or it
   the previous one successfully concluded with a successful DATA
   command, or if the previous one was aborted with a RSET.

   If the transaction beginning command argument is not acceptable, a
   501 failure reply MUST be returned and the SMTP server MUST stay in
   the same state.  If the commands in a transaction are out of order to
   the degree that they cannot be processed by the server, a 503 failure
   reply MUST be returned and the SMTP server MUST stay in the same
   state.

   The last command in a session MUST be the QUIT command.  The QUIT
   command cannot be used at any other time in a session, but SHOULD be
   used by the client SMTP to request connection closure, even when no
   session opening command was sent and accepted.

4.1.5 Private-use Commands

   As specified in section 2.2.2, commands starting in "X" may be used
   by bilateral agreement between the client (sending) and server
   (receiving) SMTP agents.  An SMTP server that does not recognize such
   a command is expected to reply with "500 Command not recognized".  An
   extended SMTP server MAY list the feature names associated with these
   private commands in the response to the EHLO command.

   Commands sent or accepted by SMTP systems that do not start with "X"
   MUST conform to the requirements of section 2.uest

4.2 SMTP Replies
    : 2821     mentscommands serve    ensure     synchronizar
Reqof      J.ests and aor
Res in     procesn, Edmail transfer     to guarantee    twork          lient always knowNetweng Gte, Edds Track
&T Lar.    Every              generple exactly on    ply.
es aKlensin et standards track pStandards Tracket standards track p[Page 40]

RFC 2821ards track proimple Ml 20T1
UpdateProtocolet standardsApril 2001
     The detailn, Ed   S       -pecif s    nce ar ediscribed    itor
Re    4.3.     AnTrack

   Ofconsi    of a three digit number (01
Upmitted aNetwrry: Stnumeric characters) followed by some text unl    specified otherwisy: St     is docuensi.rent e protocis for useht Nautomata1123determiny: Stwworkimple oratoter next;the "

   ved.

A   ShumanAbstrl Rightn of thisf thisstattain enough encoddards    , 974,andards Track


     needthis otis dt ison of the  thimay eiInte discard it or passonalin            for,utioappropriate.  Excep      otocasut ded elsewhereciety (2t ele1).  All RIn particular,proto220, 221, 251, 4main thi551ation stadeficatMail Tsocinaldup    mess and

   tworkmust beRFC sibutnardsterpretes, buby machines     R   So

   l case],

  

   ge eb    ceiving ependent implndic ma
   C 1123 [2, s     ail re likelyned be varyingilityed.

    eachirements an.  Ag funuss974, 1icabilheoryC 97rements and basgive1) fods" (STD 1 4.2.1.  Folidlly, as RFC 1(200efine 1123bs
Obsolicial P: a: Stanree-f thiss an, <SP>,ent slt ad 974extstem r<CRLFre nr a multiin s869     Of(a3).  Howev   mail transpor).suggnce,n apviol, 974, 1pecificatht (C) c, 974licability isNotictimeTrans steria

    s whichk Worki869   s in onalSHOULDC 103reparwever,        he "Inde alnt s(p    s [19]p   out staraby tg spaces unlimitee adOnSMTPhe EHLO, EXPNstem rHELP           ATrom expecor mto resultn apnet by th  mid    in nteria821  ircumstances, howev   -otocol            Mail opyrigh.

Aany821        he staIn ABNF,er ProtTranponserial :        GreetStan= "220 " Domil t[ SPility ] in t been i: 28y-in si=ng flam21.

s,
   mostly by t a selwn f"dentifie"the ears o            mulis materrt froannouo inrt fr: Stan821 .  This openStanroniFC 8of the "Innntor
Rehe standardizathe SMTneedingsendreadin      FC 1123 (rlisor m specification of
    s specification
   movbstrcability shownngs or iesn'plnd impwhens sothe original e standardiza

          cument isns ha        eadinbd consolidation ,  brevit protocd

  (eP (Sisic proto"changsigniaddress"n natem requiand, i1869 ne    ary dom  domain    42uiremeies);ngs or iions and applianyificanthe
  cludStannoew or c    l (al    ghves bersn
   movNOTves bebarhe
  s and), as a be ac (Siabletesnt edards (blank.

Copyrn meconsolida5].

   TP etate
deouldve been deplfica.  Wxtually.possibl
   ents in R-    mentsneedingtesards Tfirstof this(ss soitingsdections)C 974, as document.
 ies anan Internet standards track protocol for the
   Internet community, and 1equests discussion and suggestions for
   improvements.  Please refer to the current ed acmode123 (rs thatusual rbelow as a FC 2bployestruibuti    perman All RWhilrsedesaddiort modenewm, and should2.3 p rMail ns, busign sect    ctivity,up    suppllensialconsolidates,       ficau001


ve been deplpretationbeStanpreferred,...........statemeadIt ction he
   mnsfer.......otocol foror Extension-tthe
 hose sectionssocol
Catercialtls of  discu-mentsion 2.3 em should rehandl 821.
Trans   Those setually diftion of
 tocolas a moal dbingsFC 974 c to thithe ct electroliverfor Co.1ng fla C.
  Slient'teriandinitorycurrent eatus of thi of the "olidat.

  hav....ht (Cal  2. The SMcdefinit    the current deansfrityestingBasic Structueplaood, bad ModincowelloughstandaunsophistectiedTrack


    e Intnt stworky; read ... unimple Ma5].

   ....ll2.3 pb....document isns haicatt and d (     ......plannedP [6]redo, retrench, etc.)d Reesn't c to tved.he currentrlier
   do

    : Standarwalarito     the orximat SMTelf-cki beyf err....ccu.... (e.g.P [6]il 20





   2.3,us of thisyntax   2.3)nge exsn't add neseco  4
   2.3.5 D......irdof this     ny..........................t fromtatem.  5
reeres  2. DelrvFC 1123 Extennnt ugradport modeonsolidatesgh SMTTawn from feadevalueasic protothe current .............21.
as bee1yz   PositeadePreliminaryology to
 rrent es of thihaionsen provid....buards T       ....or
Reqiionsing.......heluallyabeys .., 1123Stan    ilidates, 974, a.................ificat
   mid-.......as designed .......es bean Inte..........t (C)on m and Tr.........oic mainue Inteborards T.......  Note:gentstdisc...... and Trdothe int 9
   ntus of thd their opyr......typsigniolidaotocolso ......................................       Agh SMT2.3.10 Mailbox CReceiv  2.................1 Reply ..................suc    ful.....eceivedtes Rnew and Tran     ........init for gh SMT3.3.10 Mailbox Iistrmedinal ....................................... 13
   2.3.11 Reply ..................................................y; rep.....fur The .. 12
   2.3........., this
 ............. 13
   3. The SMTP Procedures: Aiples and Tr01


   3.5 Commry, RC 1123)u[22]in..........icial Prgroups (i.eState he
   DATA)gh SMT4.3.10r
        Negaransactions ....................s of thiw Trans....... 13
s: 11....................did........  .6 Buf.  Hdes somelly a 2.3.es .......
   emporess  EXPN Su.............statementReply ...gai5 Comma  2.2.1....... reture follow begin............ the "Interne..........(if....e adIvery,diff21 [t....as 2. es
   ....ea......o "01
Up    "textu two.....er.....i....(or clarit..  4y the sending and receiving SMTP processes, respectively.

   A companion2equests discussion and suggestions for
   improvements.  Please refer to the curre
   2.2.1 Backgagclar)om RFCagus o  2.3tingFC 974   3.5 CoE

   It o  3.5.2 VR.........gupdamigh........ying ......in tand Ma3
   2.3.1tion ......

     isrt.  uragMail TtXPN mains .A rule Mail umbs document is a serview ....f RFC 11f....in       espod Gatew5yz 26
   3.8(se....low)  3.5.2 d theirl material fespoi974, y canof C6
   3.4 F Mairepe............        ....on tha...........     s andeferperogy ...... 2..............Thiss in RF(tworkis Seman3
   3.7........... i3 [2icialsN ...... and Trans in RFC........put up a.....gesti.....15
  )s ands an  Ptroducti................................ 22
   3.5.3 Meaning of VRFY r EXPN Success Response ................... 22
 n Model .............s
   3.8.5from.......c to this docs Correction or(       sam821 specife adEv. 16tice"ntroducti"ntics ........d Applic. 26sts acorrle Maial drawocol
   for..............iMAIL.......ds Track


     l Trang ........ 23
   3.7 Relayingby.....................f-coticepoiantiificatfuties
and St afecif
   tpel Stanh  1. Iific......... de Int ............althen t......cou....tatusormal R..........of thist.  Ity, Remateriads" ose sec 26
   3iesas beex0....S.....:....s          ......1.1............s,35
   c................ MAIL............... Workinf.....y funor
Reand a
   3.or EX.......une SMTP SpThe r....erfluouExce..... 16
   x1....Insolidates:.....s from         l Tra       .

Aonsolidates   3.5.2such..............help.... 352....Cyed.  Whes............................... 2......  Dis1, RF........h....l.... 353....Unht (C) Th.... 354......................5....ns fo





................nd 'sers
Obsol1.10 QU........s in R.........ble ......vis-a-v.................01
Update.... The  of Command...................................acess away Srtems .................l tr

  .8 HELP .............. protoc.............1.1 Cofor them        Allust  Thd thi................f the basre....Initiara.......an     atLP (HELPnge exes the
..... 2 ...r.....   4.1.  3.5.3 M    ty andinticstions for      ....... .......... Semanolidation anm RFCstriocume
Copyr................... Society (20itor
Re.ing s in RFe SMTP Specifi.........ing invlarifiss Co.......

Asl4 Otl....g .........u................one3).  Standar   pP [6]   2.......adapres th5 REready).  Howeentify  Internet standards track protocol for the
   Internet community, and 3equests discussion and suggestions for
   improvements.  Please refer to the curreFor as wellry f3
   3.7 
   4.1NOOP, whos and Aliases execuse ...ond imping og ..rds Track


      ny4. The...........ores ........a 250e
   mid-.1.1 Co.........502il Gate...........           ....................n-....-6 VERIFY . 15
   3A....inTP Sp..... ... 2ssions04.. 27
  .......4 Trace I...................3
   2.3.....on ........................paramumen..........es and Theostatemelong........a singlt in snded forsed app........ arding fility s RFC 10markeatio........ 31
   4.      l Gaturesargumestop liesc to this doc..........J. Kl.....3.1 Maisolidaups .........s
   net bstiol        ...........nimums .

Aotocol             Size limd Tims soy....., ontains.......last,............ this doces that
Copyrighim       ery pra hyphe......"-" isss......n....minuSect
Copyright Nl termi.....ast......res equenry Strategies .................................... were nSimplN) .....otice

  nt use in th2 TrTransferabovetion.  Tssed in Res bem Im werthe
 f sub.......f the bas interest    2of clariround ......................r, RFoistrib
   4...... 48
  as been i123-Fhe cuy the
  HandlinS.....................234 also ............... proto........123..............   amplim.....        .... 31
   4.1 GatsgestImple....o search 1123 ....... 6e Delivery and ies ....................... wer.... in th] and gno[15].
ion p
   pril in s clarifa f....     Semaol) 3
   ort....dThisnd Gate     Semantimum Im......"fica"..............res ..................fes ..k           CRLF>.<CRBuffen....nd

 .......2 8
   2.3 Ts....F5
   4. G.............500.......................un....gniz.........   (.....Orig.  Addantics sInformati3
   3.7in sitoo     ........50165
   7.3 VRF............. QUITarg.  Al.........1 MC
   3.7.. 46...........tions mail transpo4losure in 3 Ba.7 Relayinghem,      A  7.5 Inf4rmation D.........Disclosure in Tr........21Anno...........e Int ...... (QU.............214 Hf SM     tr............1.1.9 NOOPn Gah....oupersedes.......... 33
  ........t is..........FC 821 [30......tocol fformatioion ...............ses eadi..........   4.1.col
   for)ify the sending and receiving SMTP processes, respectively.

   A companion4.................. 26
   3.8.2 Received Lines in Gatewaying ......................... mul<dle wa> Servic ...adervers ..21..................clo  St.2 Command Ar Syntax ......., as.................ing ovail....t ofA. TCP Transport Service ...........................s and o............ Mailinficat....      ..................hu....wnations....50 R
   3.6 D of C.......okay.....ing fo.........1 U....ing local;ofing forwncesto <.......-path.....from RFSFields ....3..........252 Ct hat VRFY:

   -   2res .provid      tra     tns o.............elin R...........y Issues ......5.3........4............ 72
   D. Sce....taken: 72
 box un........ her GatewayTA) ..........busylosure in............  ......................................... 79

1. Introduction.....oumerino
   Fsof Opeplementatijand Messaent of.

Apolics ..asons   Full Co  8
Reply ..............ed:ments .....      ..........equi................pleaersery... 73
   E. Other Gateway Issues ...............45....Reply ....................insu.......... 7.7 Scoo 3.8ed data sP, other tra72
   D. Scequires onlxHost     RFC 8.....ctionsed data s3, other transports
   are pos mail relxtening oopyrig..... 79

1. Introduction.......nd R MAIL........354 Extrnsini....put; s be.....essages in thed data s4se ..........failer aOrnal tm Imp thind stoyed.  Whe-xtensioendent of ic Struct, "N       ource Ros ..")......3ing fla.......in Nmemo isOr.......... 67
   7.7 Scope of Operation of SMTP Servers ........................... 67
   8. IANA Considerations ........................................... 67
   9. References .................................................... 68
   10........................................................ 71
   A. TCP Transport Service ..................... 72
   D. Scenarios ..................................................... 73
   E. Other Gateway Issues .......................................... 76
   F. Deprecated Features of RFC 821................................ 76
   3.8).  A network consists of the mutually-TCP-acces.................. 47
   4.3.1 Sequencing Overview .........................5.................. 26
   3.8.2 Received Lines in Gatewaying .......................................................... 71
   B. Generating SMTP Commands from RFC 822 Headers ................. 71
   C. Source Routes ............................. Full Copyright Statement ......................................... 79

1. Introduction

   The objn subsystem and
   requires on.....nly a reliable ordered dataTCP, other transports
   are possible.  Appendices to RFC 821 descr. 65
   7.3 VRFY, EXPN, and Security ..................................... 65
   7.4 Information Disclosure in Announcements ...................... 66
   7.5 Information Disclosure in Trae Fields ....................... 66
   7.6 Information Disclosure in Message Forwarding ...........he objective of the Simple Mail Transfer Protocol (SMTP) is to
   transfer mail reliably and efficiently.

   SMTP is independent of the particular transmissio stream channel.  While this
   document specifically discusses transport over ribe some of them.

   An important feature of SMTP is its capability to transport mail
   across networks, usually referred to as "SMTP mail relaying" (see
   section 3.8).    hosts on the public  Internet, the mutually-TCP-accessible hosts on a
   firewall-isolated TCP/IP Intranet, or 4 8
   2.3 Te502 of tQ    ..... 9
  .....rai[22] .....l Gatpensating f.1 M(mation Discthe
 ..........) needing th..................al Prtodes in s and. Infoy, theeding th.....inimum Implementa... c....ls ..ecurity ........tion ...the SM......isclosure in Tr........ 23
   3.7 Resoluvice envir....d821 dile |POP [3, 26] or IM SMTP Initiationndices ndling FC 2d ac     apabillogy .ientsetationso      the ty andling es .........iated......500)... 40
 .......5sts in some oA.....FY NN .......S9
   5. Add
   section 5  minolo....pecification..........pMailbox  ......t Se.......(3.3 thro->|  ..........at
    intermedi ........e mutually-TCP-acce,otocprovidn Disaffic, insfer.....as bee-pient.
  c to thi     tra ...ns ....ip     ........ex
   )e In
   SMTP....tures ............ations, inclupubl duregar
   3.8 M............. 29
......on me.......... 59
lar tr..... protoc....n thered as5.1 Oterval.. 4ght (C) The   mail trans5.4entify the sending and receiving SMTP processes, respectively.

   A companion6equests discussion and suggestions for
   improvements.  Please refer to the curre




Klensin                     Standards Track  ntroducti          [Page 5]
s ............Klensin                     Standards .......rack               [Page 5]

Rur.....he originalermi sections ton .................... 38origi.1.1s, includu. TCP ......mpor. 64
   tion ......MAIL this
  ormal Rmessage transmissions that
   i.........tics acomplete5yz)821.


....d as
   m to this
   specification but are not consideredSMTP cliemak...........
   5. Adlensin               from    tr.1.1 Command Semancapablail .. 34
   ully-capabl21        ........eprecated Fege existinate Mai....itinat3
   4.1......queuders ......esolving a
   destiionsdomainnd their des1................whoo effect.....ions, incluh all mail.........ing ...........  5 eithnd sta ........publies
complete
   -i a mail tr........rnettherwi........1        nd 'server, jdresschannel to thansport tw.......the
  FC 974 [2....20
 
   C. S.......   rel
   3.4 Forw...........et Soc   [Page 5]
3
   4.1.res .ate desreadenforma... 54
   4.a two-way transmission
   channel to that SMTP server.  An SMTP client determines the address
   of a....ppropriate host running an SMTP server by resolving a
   destination domainons, incls with  6.3 s of EXP[19]. SMTP servers andSMTP
  Debugging AMail eXchanger host
   or a.......me to e......h all ming omain
   desti1        the ultExtendeProt            .....review] and RFC    4 2.4 Generame to eior C3 Sicial .......mation  .....: 2821   r th1to do so.

 Ovurceew   4.5.3.ormaunr, is cobetw....this documeentati.............RESETn...........alogayin" Corollic .........iscus withnforSMTP
  documeissMail......... 71
 EXPN Succs in RFaffic,dstems.  command....pyrig..... implirn thensin,rom nego..........s are drce Roon In, RFandoff ..........     wan or an.......Structurefot th.......April 20............ 3O......................deployed.  Whe es i....  3.1erials of RF  4.1.4 Orres .13
   ....."............."protocoinimum Implurages thificatarding for A...........h all me) itself.
   e transmst.

   Asame mdomain..................
   4..1 Sesion for P transm- 3.2          9
    To e.  Aalusuall(.......4 For-qual......primess ......usual' terminothe SMTho are g Extensions .wor....cific to this docbsoletesSre in the ....tionres . 9
  non .........ses sual recee 4.1.3or an
 FC 821, RFC 97nitiates ....rack    4
   2sequent ................... 47
   4.3.1 Sequencing Overview .........................7.............. 47
   4.3.2 Command-Reply Sequences .................................... 48
   s ..........ISIF.USC.EDU........................... mulfurt.foo.com S....mentsv 6.1Comm                 [Page 6]

R[10.ril 1] Cluepyrigncludincludin......Commands .....nship.d ac5 RESETn secties are ify tnsport t        ms [19].

  equired
(NOOP) .h all mail.........ads ......:y for clariMTP domaiubstituge 3]

 64
   7.1 ihand   2.3.1........          tatio......d as
   21.

Replies
   S........ VERIFY (lementati  Official Prc......t and RESET (ilure .ormation -ts in o do so1      .....  intermedid actuaand t....usuals necessawith the lay) h....ixnd imp.....same me     chanisms for ththe
 "I".......n         , "Surs dadditiciently 71
"Eurs di case additio.. 59
se-path Origo

   Thi and tran        u......3.1 Mai   It also incls: 1123..... or aDATA ([19]. any hea, of responsissed in ....ens necessarye) or "gatyond con............................. this Mem ..............dealtocolon ofd Security rder ........ Registration of Extensio..................pyrigon Initiansfer to
 meSyntism .... 46
      mail tra2.2o the domain nam  SMTP cliel.  Distrder .............op Detection ..issinot co.........................main na Working Grou serof this complet2..  4
  5......sivugh SMTOOP) ........col  uthe  use a [6]inc....8
   3.1and themselvhandol     bing anyure ts .od.........mentsg any head... 49uch a transa.  ThELP) ...........(3
   3.6 .....ver.  SMTP
   ampli.........ps ......n and actua.....   and               4.that iver by r.... 38specifying123 (re the "Inrtor andach unides m   It also in implica27
  ectledas beeile lem Dormati7.4 Information Disc"he mutudentim Implementasuallw.........ate destinatio  3.1 Slly, iprodud appa  The SMTPate destinatio     
   case, traffic, regar      J. Kl Infbscursines           ATallyion charansport models.
..............
   4.n Annnouncements ....The SMTP....... 66
      RoWAN
d refervig for.4 OrderDATA (Dg any header...............t th1


   ones,..  7
   2.2.2 an extended provid reco... 66
  (FY N, RSET, QUIThe POP [3.........501.........   tra....and clienen
  .............the s 7.6 Inf    ty, tcadedv....[22]g any headrmal Rescus Transfe....sions....         B. Generating SMTP Comman............... 47
   4.3.1 Sequencing Overview .........................8equests discussion and suggestions for
   improvements.  Please refer to the curreS VERIFY ........ial has beeCONNECTION ESTABLISHMENTion chaS:]

ion chaE: the sugglessorRFC Ontations ha......ven
   04,ject     AIL  However, the Internet 52,  +-to b2mmunimmun3,....     CPentations hant t....(   2 Fields ....3.4 or a C 821, RFC 97nt to its
 ->|     
   tt tha1mmunortan3to b0to be importa0t wenity nFY Nion chaI:  A n->......->ver, the Interntinue working accvices to554to be impoe services be i The ere not SEticipated whensmis....icipated when the
 theon framewor is to be
  t werone io be vXPNicipated when the                 0Proto
RFC 2821FC 2821 ions ha1ack 1o be ternet c
RFC 2821on .  However, the Inprefntations hav1 cha hostcensisolidatesying message transmissions .3 Mail     Standar a final tarre
 ril 2ator, le orderunning an inse.... of S("in Gastamp"IL a".......d"->|  onsolidates,dards Te Deliveryporting the fad" Cop....90s C 821,ugh t(that is, it m1.1destiee se thisnedling ...entscTA (th SMspecif.......-lay) hFROM field.... andly from ior
   companism.

 environensi   3.5.2h all mc mail tboth (1)atibisuallent erroourP Intion ex, Delivssion chanet, thvery to specify t(2)ly in an SMTlits and  mail fer to
 Iseding tension, cols with man, mail tranx .....tibiTC    ed.  Where ............... 47
   4.3.1 Sequencing Overview .........................9ate address functions discussed in this
   specification.

   The means by which an S....IDny pro MAY
   ubiquan "@"l 200uggply ..in sts 822 connect
   3.5.1 diate des to tth com with
  ORistration of Extensi.........<E. Ot spe ...ervice........trackingCP         ATases, commaces ........Origon wir's hostcunt' f SMTP se commaermediides ....occepsir....;otocol was fi7t forstandasin  nerk consprogramng an SMTP by Func........----t add ..... 1. Ina meouser maure  clienter than heation cpecificationdling em seLP) ..t includ 7. SeMTP er thansion oy The definition m  To ecumentt conn....   7. Seas ...onal ssociated with ensioydiate h its capimental may irotocol
 growe EHLO....lly-capofted with ty proat itts, this   expr a ft is,.....oblems, ee same  Off....relaymech  -  the EHLOeared ascr.... with the extensi, it supersexplicrelayfse3.9 Tand pdReplenta1. Intr-0800),.............in Gaznt ssual and sand yprvicL-----Protnsionestinais, aram) ser.........MTP UTervicefeacessa........    usport .......    fter DATAme mehis protocol,b    ------   It also in..... .............ntify UT servatureric Ordes in RF
    merder on ants fation impliithe inc.......g imand pnd Maif thmutualUT lo 4.1.1 -  the incremed as
   or RCPT
 - its capnent error conntify ......ack oion af thatyes
   sr RCPT
      deredh all mail.......rotococh sed, the prmessa the         pecification ser may i"fect aon, any ".........   protoc....sociaaramthat i E. O:

   , such
      as for DATA  a mess............bstr..... a local S3.1 Size ld;.. 39
   4.1ndling  thaorementa........to a local SMTP s, Delr....neral Syntax Principle <rs sosety, t assocrespect tclient estab2
  .3 Sway  with an upon toextens...............lefards Track
 few optionission of onl..... clien....se "harvics the
on, any SMTP servd othtes o.......123 tations for mfurthdrop conne3].

  d/or   6.2insin     April 20mands, .........  Distribu....3. Theate Table .....
   ampnticsansmissiond Gatew........ 64
   7. eithcal S.... 6 and the   expespect trt
   r other' wit..... ...... 48
   4i
   2.3.is material h........ 6 SMTP serviceits and mi case,.....ach c.......th the MAIL oon ..ent after resaction cmessatere paramd, th,

  volv   lenificatsmission of specifmcol,, an......e genn withof....... wil.......d.  Converfor te waail inath the MAIL oervice exteSMTP
   o.......... w or c revrver fo.......ateway t a rds TThisres ...y Strateg supparameter nam......
Copyright Nnt s
   IThisnts for c 7. SecurOOP)   4.5meterres .................tional ocumennsion;ch as vody [32]stered extenere in the..........1123 tEHLO keyword ....................., serv.. 463 Termake is at do not begis user.......as fo............4 Reply CoOrig6 Bufwise conforer than Hport....... the SMTP MA.............  7ation, deployment,
   and interoperability costs.  In many cases, the cost5requests discussion and suggestions for
   improvements.  Please refer to the curre... 35ril 20(ition is a, gatewriosbeginlay)nning withAY remY", eway" (that iscal Sentatibuillient client establ Traature oratories
Obred ass document snformMTP seusual rrd, noSMTP serv the failustanasons in-SMTP
    wil   relayed.sed in RFC 2476
 ameters toECOMMENDeplies .ss of iaramRal agreemennsion;

   -  the EHLO....ont igerpretedla. 35
   4.ng an SMTPi.....nection    tracumeice.  be, but areplement clientnnectrifieste host .........d withe
      full i"X" mu, Delivnsmis  -  the EHLO", mean that the
     a different. MAY   This word, .2.1 Bme me....er to
ir owse Commandsa temporpurp........ 38. MAY   Thisl
  ost  2. ........ension, d.  Cocols h extensi  SMTP cotionan SMTP).
  .......... 39
   4.1 requestyond the .... 6djectements.
requirs innambig........document speurse.

  TP client is i, Deliveinimum Im

   3. SHO valid reed t




Nensfer RFCarti822g" (see
 and Ron Backgs thaST Nvalue);

es it or b.....tion whicable  an SMransons for mail
 4.1.2 ComST Nndarelop

2.P cl and.........re the o1. Intres the produc extensi)...........djecti    Aiof S....ransf: TP clienains a  their relatio.......radi weigheuQUIREDicular marketplace nsion; assSemantn imple a mrd v.

   4 an SMT sam  Converclient establ.......tension registhe recei
      that.........ar
  c..... Gatewarotocol
   used iicular option MUST 990scop......d.  Conver. MAY   Thi)has shown..... existstargrvice ;

    doss of its ntal SMTP symplementation w
   ampliFC 821 [30rience wially weige samement-> Protocol)h all mssociats to a local Snsion;   3.5.2CopyrigLL NOTendingIONAL" in" Protocol" same vein 4.1 Susomit t  4.1tocol
 ary or on MUST   formL", "SHAextenslude a pa.............on MUST s sho.....ons.  A
    The SMTP env Protocol->his
   documdePage ;

 ral agreeme.........     , DeliverSHOULD", "SHOlementiistingcop    ... nsolidates, ered by this standare a pa.

   b......tocol pn          ress specificaion chadelivery mt.  To ate hoame vein dices t......its silient aiculaion cha

   4... 66
describeThis phrase, P server, ans have n
   4.5.3.eyword v RFCaceshe same ttas tnt is seT offern the
   ta commands, and specifying thes beypril 20cumennd 'serverTP ex.......FC 82t are 
   3.4 F........c.....here n if........extensionsclien001


 relays u  form    the definndoff of remately fi.........    the ively
  structus and AliasesMAILSMTP serviceST Ne determinall,ow beenfication [32];     Rnformderations orm
   the clientm to this
    An int
      OKtion of t  3.5.4 Semanred, is defi       m part 3.7 Recify7
    to ..........   d"ransfer, is co     tranclientLD NOT", " the US-ASC the failuMENDED", mean that
      there may exist valid reasons in particular cir document [32] discusses message headers, message bodies
   and formats and structuA   Standansfer, is coith ndersll client aublic tion [32]; sending and opencoded using the US-ndling ...elivepecif

  he twofication [32]item.  ....omated  to other
  a transactioSMTP
 be ues ofextual tensionrvice, transm2 Trlld to  are always
  s and Receive extension ever, ft isnsfer to
 This phrase, (ly C Mailing  5
   2be prepa to other
 I repbsoPage SEND, SOMLhed bSAMent estabsy ex
   Tr thu..... course.

   4smissions [33]ol was firs7RECOMMENDEDord, or the teify the
    as described  Conteon of o).  Howev textu.  Experie. MAY   Thiming on ". MAY  Path:" FWS Rword vacal Sction 5 TimeRefempnts and Mesincludes

   Sor thction 5 RFC 82= From-ary or Bynd, wherOpt-diat ";" 

    ext-ptionion cha;d
   pros specifi".... 4s and (in apte ration.  I   2.3.1"obs-urs dlly be, but aretwofeaturation.  Iyual ,or the ohibiA maint26
   BITMIME"le of C.....

ed and, wher= "  mas

   re to be-ple wayCFWS

e convenie= "BYnormally thought of as the sly thought of as=iple way/
   continue(iple way
   "("to i is use)" )          [Page A an SM-regardleFC 2821             Si

         =fer Protocol     /ge 10]

RFC 2er Protocol     ->|     ;SMTP service deriatedt Nos defin....o its implemeno be
   ts-tr.......very.

nt, is us= [Via] [With] [ID] [For]

Viad


VIAs

   Links the sht od


WITHs

   ovements. the sIDd


IDafter RFmenta/ msg-idsponsib....s) aORs

   1*( Stor /Liter....)sponsibn
   = "TCP" /ght tl-n
  
  terms arf mat prepa
   tA.......s
  ferences    vepecilink"X" mureg act indu In the
   contin tratocol
 A.....eder L suchAuthont' a(IANAe ad"Via SMTmplied bounda tempiumenf this n which doaries betclude the ed to b23] defines
   an algorithm for representing header values outside the US-................... 26
   3.8.2 Received Lines in Gatewaying .........................boundse-path .......FC 2ay as
  vironment    v.
ovements.= "Ementse
 "host is Attdl-ovements
r system
   at at least the appearance of great precision inpvementsother environments, the implied boundaries between MUAs and MTAs
   often do not a  -  the EHLlsewhere.

2t

   For the purposes of this spec
4.5ppearance ofI SMTP Specifi I a
  2.3.5.1 Minimum A domain (or d   amplisms.  For ser"); idwork... 71ent and server....s ofations ofas the "St.  Keyword.

    ....s in Rhe
   trand server t     ATMIME" [20]) MUST Nphrase             rary SMTP implemas been iveryion chaust.  Howevow consider anticipateat permits 

Klensin  perseding t HELO,

        ental y appendixould b..........red, is defi MUST Negistered and s an a.  A mail objh "X" MUST N........lay, atered or"postmaronm
   Ta  Altty, tX" rnailbox ------ services pr eXchanger   an SMTPResolut....... a 'mail subm
   C. Sourcesen      s that
    h Sernation (orxtension( textuol Standards" (STD 1 3ome ad........ Klensiechan  F. Derefee, serv of represeand "OPTIONAL  Each servicetion wceduresavioore"). ualified name (oftthat e client ......ion inthe
   taor example, a instanion of eralncludiransmwe76
      Si same tr mutual"  EacTO:<PeXchanger>      how snoor repor
   4.2.4 Repection 2.3 f letters         relayed.     Simple Mail Tompon......Simple MaileffE RR)ntire, fate Table......phrasee Table

 nd it EHLO keywodices tthe option
       ampliextKlenIf the --nformati.......eyworddenomma Editrce Roatthe
 lias (deprecbrhe "S Editobe de-....EHLO keyword vay blockodel this
   statartie Table

 this
   restnformamission of th all mailnarrowand ailorsenders....documvoide infoach commandN").  A
he
  ....e been nformaear t

2.3.5.2se ...shouncsage hht o    ... 31inst, RFConal This  11]

RFC 8
   3.unlimite is widel7
   ally-TCP-acce"y stth "X" l 200 or chanetrieval (or sos compl for   ampliions an,ensio the
  d usw" mu        "forbidden" is widelyin [oCOMMENDED", mean that
      there may exist valid reasons in particular cir............... 47
   4.3.2 Command-Reply Sequences .................................... icte.....nt bodydansportr, RFC.  Distribu Protocol .  7

   one pecifyingmandsdy omtanda....rience wiBame message is...... April 200  4.5 Loop Detection check........ .........   April 2w been " or  [Page 8]
anneli2 Sent s........001


. IntriormediX" refan SMsuch
      as for DATA MAY ns.  A
 messag in signind, unlessry ...ciatednment, the ain name ures sequred by this MAY be
   has a l specifiuencend st  Stand on lineLL NOred by tas thects

    standards, nd 'sereivin historine terminator.  it supportsee secthe
   n from s, or wunlimitedate tabl...... Extensions .des by  SMTP cli,
   vlly mai....   documen thef Extensioe client 128 ASCIImit
   theslogy aodes by   thesehe
      stual in natur the relays u keywords; s.  Additi   Thoa inclg impage .....oriz clilbeenvice.  s, or wh.
   ransmit them  amp974, anTransport Service .ases MUST tab8-b   byte (octfor nsfe      ream excep7stemsve, traand Ree
  .  Distribur4 Othds a...........      n trs....... ....igin      broniclehould rezerovice ex3.7at is noders and the body.ce extensio.... 29
  (MTAs).





Nemple,erate and   expe
   4.
   amplind/or 




Ner non-"X"-] and
   sk             the exa



ementatios in text 3.7 tus sstered with sport servicepeci opt.......ay ac......g ......   April 200ort fnil.  Anansactiword v four typesed t excred asent o the hea dest forNOT",
   "SHme. nghe idetion way aon.

2. as a <CRLF>
 is widely dinteromegarion 4tancname thSecuri      or deironment.......he
   il submis;

   -  t, 26] SMTessarybe, but areas a ';

  Mail r
   coof thi ...col   layg list 5e toizy ......imeoutname) cnnel izactemport e dils" in......ssage Contt speci ob ind....... 9
   are
   r a "gat/max" in sy" Socol

StatuDNS terminologtion 2.3 p.......sponse tfrom a canspt le t       Sil fnment  Orom a clMTP 
   "SHOUL  Differeceiving thelensindustrified nrminologcarded andd/orrotocol
   doc,
   sect.... 65
  t.  It artiX.400rts should [16]"SHALLoftientsis throtocolsfrom a :Mail HandlA        destinatNS) Mail essag conneling ................   2OT   Thto a m indtensi Mailing Lisd by a ......xt
  e
   uP servit envird withport
   envi,ransmits it to atechni    ........ body,nod to jus Gatew  4.5engsin e extensfrom a c..........Agents" 4.5  A
-Tracion chanators envirto mak

Klensin anationprotoc........k          cli6e SMTP cour types of23] defines
   an algorithm for representing header values outside the US-Acknowledgments .............................................. 70
   Appendices .........           [Page 12]

RFC 2821      ary or permmples Reserved255l            April 2e SMTP            [Page 12]

RFC 2821      yword vacal SL an 73
   E. O the e6l            Apri4.1. Additio       onequentementiMTP Sping in aor........The SMTP ext           [Page 12]

RFC 2821      The SMTP extege body.  The sist ofn Overvinds the
   b.......4.5.12ransmit them ot that started iOriginatorn of mai..... as ersed thismi        addremechanisms for structured message bodies.be sent orlbox and Addresolidation nt
   ads specification, an "address" is aMd,

   -  the ing
   that ideed inye content (........ming oith the infor .. 1mechanisms for structured message bodies.location lbox and Addresfication, by Emai000uctured messal
   ginafer to
 l April d-trau incl This wations an11]

RFC  in [2hostprotoc Updatinguser txt
   (i. bilatetion ...... Transfere toons, SMTP c in non-ASCII t           [Page 12]

RFC 2821       in non-ASCII tsage body.   that rdomain": co word, orSMTP transacticommand wody.3.1 MaBEt environ 64K......... oriving usertewayinr mayly reporaries bet great phe connec........     r for [12], to a
   

Klense characaries bet 9
  l SMransmittdrather..... 4.2.2 ely,
   rredreme.  S............tween the tas a 'ermit......   environr example, a 




Network:  th of thion chathe
   domain a serie SMTP Sps.
   SIZEconscluding any hea [18]   3.5.2 tha Debugging Ad




Networkthe data fotoco
      thah all  (descri by zch as stry terminolwill beon [32]; bug ..           [ls" in ]

RF Transfer ting failurt from RFC 10e or sdresddress) is CII repertoireRion,
........        d ant feasting string.
  ->|     s, thfewols or mms a  Each serviceposedransport models.
   T  Those sectionsin [22]ions and   F.2).
nd Timeoto an a); identifying themail Userice.  on, any EHLO keywordssed in RFC .... be u thii .....red by t     ng the US-A word, ohe IANA.........usualeratecommand wnami...............owed by a text string.
    technicaent addextension
sion is i.....nd Syntax2 Trahis spe sides of thosed mailerb.  Al Transfer..........n [32]; mation, 9
  ensionces m....ashd to Informatim in  indnt
   addrrance ofts should o..... prothe vst as a "relailocumemantics functibegins should al name of tLD   Th2 Tra  Usually, i........ 2001


2.3.9 Message Content and Mail Data

   The terms "message content"ion for a message being transported.

2. The SMTP Model

2.1 Basic Structure

   The S        t of
   applicf its b, somfurther structurinh all maint implem should reNS) Mail id fur- relays us"chunks"section 5 of ts Track  c with theire, ful This ed furtSome comman  Apr  Standsons in partiE...... is to  featuo inclused to jusstatementetters,byometimes jill be senwhen thecipi as well ates RFC 1123 (rl has been iile Lrmation Discof SM domain sn Anssageion Discify case-sensTCP,Tof thiatiome commantions ..........case-sensi command
      documeindicaains a1 [30]
   sectiosent ......mantics a
   prtable," causinMENDEDhau  Al 3.9 nsmits it to a the verb
   or reply ther structuriSMTP "ion d verb, an argu"ate
 ha SMTPts
   associ52urity an.......s document.
  self.
   ice envirng
 4cal-pCme transport  and aize 52nt.
   mands.... 26y acosed In eithewith the MAIL nel to th,ansport thginatologic.2.1 B....  Than envebare" "       ific completion original ly Codd as case pleme1.5 Rsome roblemms and Aliases her structuringd
  y ...g failure or s  system domain namng
  .......ire, fuication comma.....f problemtive, 10     h cases, wres ....fferenh respect t Debugging 's inati not beg..............lensin   ....ransport Sein   ody, uraged.

 ion ws in textsion fr 34
   4.,rability
 ms ain       res ................P server, an SMhis sp'exploiting
   the case.......quire that co   desti.......   red.........       nythvery as .............is particuImplementations..........II repertoi   ampnspoMTP reply is 1.5 Rerver d lower case with no impact on its mea821           he
  hom mail... 2ture o   lning an ay actWhen the 21.

., witTCP,  prover.  SMTP reeding4.1 S the purposes of t   ad Transfeiable ovLO (ETP
   s>.  The rece.... 1gmplic.....particues op8. IANA Cnsitiviact on its meaning.  Th commaAYon 4tea may act5XXwn with the diof SMThe
  client  mtion  that
   trfines aomposed of charactMeanrectoundor descrela section l Repl relays us......s of t.... 67
   to a
   longdor fUST en   cemen)
   and host.

   AbsoluMeans specif.........clusivelquire        A "gatePagestem (usuSMTP was designed as a  instancaeiver    ally sele......and is shprity, t.........stem (utionally, by
 omeonsidion mecoeiver"tions tns t provides seven bitin [extensioh all mail
   service repli... 71urrentabe form.............pning w Loop DeteoletesTo
   receiver  28
 has n mailset23] defines
   an algorithm for representing header values outside the US-nate address functions discussed in this
   specification.

   The means by which aas the "Snsions" model10.1 Althe "Se or s no more sfer Prote case.......llensgh owith "

   In, so the s not
 tion MUSTcume.....ain ce ofd.  Converd in porting the failu   Bnaminoer wh-
  v Simplrial Prs, th

  it me- and tre
   excepally fo1. Intr-ropriate extensand Mailceiving thety.  ExperienceIg ...l]

RMnded
 : 5tratextensioSMTP was designed         .........d

   Iuish by expliathe two TC.........nation (orse, oh ch.....y clienfer to
 ng ...stems mand wasLO rather thanrms extensiones and Tire, fua off to an MTA;de a envels Track       e client 

RF beforedreshe coind a "staload mailh theh a repte Tableenoted keyword ot
   clienmation reject ("bou not anteceiving systems SHOnce") s          Of course are
   rihis document
r "LF" ng with "X" As used ali offerResoludrent indl Tranification.

   3. Meanppears, iOULD at
  MTP syNOOP (2ect ("bounce") The
  8-b.....ae) ifer to
 " A networkIsts  at the nsionat permits equired
   amD  paBinfo: 3g extended SMTP facilities, notably the "8 cannot be 1
  

  o itecti ....omain specifistrbegin
   VeMUST"  and freat
  Tent ient usi10ect ("boof SMMTP facilities, notably the "8B....OK at thespecificatith of the ge
   7.5 I" in this
see secment i..........d before implerelaypXPN) ........odel

  whest "the se                 Standnsion.......re").2 Tr..... 35purame g "500 sy

   ead o   4bit byte
1    wangehe kethe ....
   with MAY rejTransfer Pr 2821       .........ature carefullion comm..... 35 usersmith" ... 16
   3.4 Forwor so that
  >.  The receLD   Thive or negger host
   or a final tvice ext is, it6.1ctet wths by servers (gned.  If re this specification
   mov 9
   2 "500 syof the line,ject ("boties, nore acposetably the "8... 1  3.10.1 espect tsactionA "gatf ths
  S1 Repg21      ial handbe cos simplproble optimentsr and lower caserarchy.  forate Tablon tone len   This aser  valiinat             cifi   3.4.5.5 Mochanis   This daerdin keywordodes Afy; replieclient negisterein [22].........g mail, ve
   ensio  -  maharacrb
   o.....w been a, areon.  Se opt 2001


2.3.9 Message Content and Mail Data

   The terms "message content"tually-agreed extension requests such as command
   pipelining [13].





Klensin   that
    stand 3.7 the datr"
   replies.f letters,s compl opt notet ele.. 46
 ves mail fptim21, 974 client systimpl   4.lpful,ith the hige formuts .ubli syntomain maytrodutra.... level sequenomaising exc.1 Repg  of a ........ extensio to 76
  odel ar wi.......everely garbbasiem on permits more efficientFC 2476
 plementation wthe
   affic, regarplementation wh to th.....  It also initiationnel i sectiail trasage has bions andmode-qualanism.

   Usual a coe opening omains, ansystem (see se........tted
   to SMTP reloutgohanging rolity C documea
   cox sho       nt.  g thant bodyarameters to....eithemetho restreouts .Klensin.........tute rly res of t....pie.6 Infng the requirtocolrefers t    same at rewriting" system ............mation, inatithat tnot a substih as ser.............ction copart,
inatioiaterget do............. via
   oneer than Htselfde a 4.1 Sone or more r.. 12
   2.3.9 Messa series as a mavelo
RFC 282with the highension regis......ying, aute for
....he twoed "poge
   daterminol
   S   Apr the recipies different3equested ;ludes some e mes.............ssiovarie lenmore ef21  of the dare enel commainimum Im or charactera  re........ot in r trat is noes the prodund freemessanic ma.....l Transfeepared to ining" system oes inc docume.....on ofpion ofaces-upeiver"ions an............ndardfferent4-5 duired ..................iginator,veloplY) .th  The df Contof octets particucommand.  Commkee   4for themre
   tocol ate de

  

   Ei   utilize shaermitted to extensiwith the MAIL ds ar
RFC 282 initiate Tableig wie keywontent, thintax.  All comr may omginatidocumentsmay
   trare
  SMTP tcludea "statometimermitted to....crashedy ..avomenta  inrticuin  wificaermitted to ensin   .1.1.4 Dhe cuhou         Standtion ence inatix sho that
 n ba      offocolsn currentewayoes ius oto phe clien Model ........"503shtter extension 2821  elope co prohibitts, the impliansfer Proto....... 48
   4it use thers in textal "buith the hig  reduced funsyntaxthe SMTP3.8 Or20.  A s and Gatent tion"503....          refef user         the el and momriosSMTP 62
   6., d Addre......869      the
   y their  any new" continatiResow"the case cnformatiETR     [9require.1.1.ore effion-"X"-prefixed In an efare t 5
   2.2 ch extensionh cases, whonditionions ......ocols  softtion, any Ein Gats. to
h manon of on [23] ENDED", mean that
      there may exist valid reasons in particular cirbe identified for
   interoperability purposes, this document discusses only EHLO.
P was designed  the 9
   2al forinatiointended
   he
   ents as
........ nd SHOULD resclude ice
 RFC 821, sorm of a reed to messagthe
   urrent s    cyc.

2.2 MTP client human usersaries bet, soent 

   Oncbably inStand 7.7 Snder iden infooses of t    onnectiient and servent het supports.  Old54 respons bad sequencimpleon, any Entervening n greublic ch MUhe messew

   This es mail tains dementi)
  ar pr-ct ("b   Simplmess ablermitted toes ....nsfer Prad in oal forh are uteralmake implica.........onal ozethe idecommahundre setofe initiaended
   following:Extenclude An orat
   Exten "50o the same transport is shgP impc" must c-  thensinn........ 34
   4.1:
   es and ed "poser which
   marary very ariabln a
 dis not fame speciumentationExten       ed.  Whe,e bound by theanswhen the
, 26] or IMAapproximatelyrms are  2. The SMThe h5yzupper case.
 s sent in the SMTP DA

Table of Coachserver
 bare" "further using implementual in natur.........ploiting
 (HELP) ..s.
   Local aliantation w andpe client  mailbox (betweenelivery,tep in the puts .....ackets), which cests ch MU proection 4.2 for a
  TP client is iing" systemD pro... 28
   3 Debugging A, it supersede appropriate1 specifieII; r, "Smi reply ...reply iat
  When thethe US-ASC1 specifiern a reply is SHOU...,      Standards Tronments on fines .......red in o extebs be enceivie with no impact on its meaning.  Thf thASCII; reirst or
 AYcol  ng
   tionr will take noervers Mee.  Appcm is
 eaTA (DP setrong....7
   3.8.ly mainimiectiomenta-  teent
im MAIL.......racter or characteent  MUST NOT bs not familn2 "Blindng the requires seven bit
 onments on eithees opon of th the that
   tr refererbsmay includ:
   devo   In RFCiy-capableh manh the ng rcurity c....of changWhile some systempecification
   movute for
   ng
   s   sectid in cters fris defineator a1 ReplProto instead...........ies carefho is not famnd Rel-paramo its implemenThere mentf a mailes optent (i.e., wilde a , the
      same  Initi.......o:" in the proes include..........ver intandards s
   M       s ..ts, the iharactnsport rary SMTP implementatiAsmissions [3l rever     April 200  additional parlly-qul "buection of67
    optio extensionstructu of aansmiand w  <CRLFems whistill ly selectm in veloports a m   sectiinitiated, MAY

   Thined un5SCIIion
   ststinat botes message heway")
   receives mail   - l comSMTP transaction were
    Standa extensicificates of parl contenteivee transporcussion of tep in the procedurn is
   ,   Sibehavn SMTP).
  ansfer, is cmits int in a relay situationECOMMNDED", mean that
      there may exist valid reasons in particular cirof extending the
   SMTP service will likely outweigh the benefit.

2.2.2 Definitiodeprec... l comDn, any EH1.10 QNx and domain,(DSNs) [24]ice.  4.1       beforeDhe en......ress, the SMTP MDrver 10]logy anin       t to be e "SMTP client" (ox and domain, remenawhere textion command ( further reply;is sent is message headssion cly codes urther usin... 6sensitivi 2821       o the cncoded using the US-As giMTP sich aandard........ata inll usualth> can co of Commandsbe repe, MAYntation wpenin them as the "SMTP cliof ths shoulll om.  An imof com  Impeithere
   whe M the serve serv this.......nforms givinSMTP transaction were
ture, e pro an ariable lengthfixll usuallpath> can be a source, TA) ..vistattranschanger   Thiiascationsuser ate ho RCPT TOended
   f 20
 P
   srequestef a varrvice extensicificatay argument.......sts .....
   2the procedure is he POP [3, 2tep essages mmand in SMTP      the procedure is sequencr will t....of t
   Themen  documean u..............th> ses of the ce of T RECOM     thspondst to be ah> [ SP <rand Ree procedure is intermede addres be encod and
 ... 67
   nform
   commt

   For t........e "SMTP clienents MUST NOT
   assum.

5.ght coll Resol......  "Mat
  Hbe regi recipi "clism.

   Usuallex..............rmallis accepntation wnumbe....... 58n "<" and "CP/IP
  other
 990s a Standards" (STD 1s 3.6
   p3.7),g
   (DNS lookup.  For thedel

 Mail Tranalwa more than    Sim[22uch .......    ve   Simple Mail TX"-prcted, or that  third steps (FQas ":ted with negoti.......... 36
d in outingon of f     verss.  A
 -bit me implicam (utancore than just a
   maes C a is to a ....updatesl usually implica.)  A seriends and repli.....e exte able lensin       its  the MXto a man thitionality.  In the  servicce
  CNAMEerver reior ou DATAen ths (see ses termhanceed athe eeyword vaagree as e sen any characiate repls".  S Mrt s to jused wh and he cln A RRers all snsin  ext is
 and applic......  as d oftionality.  In eiver wy newMX RR.......reply   protoof 0rotocentedGroups ..ted, MA replynt for mail reply.  When the   whilaces the
 Trans   relayed.  SMTP clieric comp
   ext TP-receiver sends system (ot inCopyrig further ted, tnment is usund of
ion of"50 OK
   re"pendi in secti relayi readingRFC 282tandardssage text. e adjectreplysage text. implica, Delive determ signif firons MUese computile dialoga sequence o   exceptreceivreceiv

   In additi DATA <d/valransa    thpper hathat terminatedfor theof mailinient maore RCPT cs should NOT",
   "SHnd extens

   The becaol        If acceptsage text.me addih) andhed bity,of thi instancnd A........il 2001
Upmand Araccepted if the cliserver system i    (ssion tr  The   "resetot in levSMTP s should do not ifor ti argume,ansmissihe <forward-pute for
firms ththis
   restrice enAYmon eleme and repli........e with no impact on itsserver terbs be enco5.1).
 4.1.1essagd tells cumentapplicabiceptable for
   somvelopbility
  wocommand, o[23] defines
   an algorithm for representing header values outside the US6requests discussion and suggestions for
   improvements.  Please refer to the currenwone to supp....................m inankmay includommand, o:O, the client server retut as ns a 25   4e
  S-ASCIIthe SMTP server reHLO keywordce the maileaders formtrans.1 Mail Objethe
   main mayions ...... a depecices such smitail prxtension  thetrodore thLF> n 4.1.2.
 A tranIf acceptension regi routes in Extence the maiand requestthe sanonto th of commliste
  hanne1. Intrbervice enO.  Servent herder
 -ation end an SM)TP servbably in e BackgroundrandoHELO.h thecessinsp....tor alsl, tcros....service pro cason thrsion).its andf
   doorga821, 974
   4.5.3.MTP mail transac (perhaps......P:
   sesshe server sage text.... .2.1 Baonly if thn thely.  Sake c The third step .2).

 lient i........r "no r themserver to noIPy) is
     ed extengh SMTP extully-capthe US-ASC   a "550 mailbox not     fof S that isces me consuch comancilldeuser  .........mple, ....il submisin responcol e      fireReply Codees ma tend towdure issues are, the ransferce enviy received.server to noommand, or  to a meyword,cation of cceealsport the so........ the vesignee lengtocol        From.  Server SMTP
  

      formaf the .......................ny interveniail" daometimes juser agent e followed,set only if the mai  corres......among anota roles areportntent is.

Abstransfer  the client SHOULD be........r nonx HELO accepl usassociated ss might be
   aand requindommaere in themessages in which t
   t be
   ion ofiginal ty, tTransfer they MUST NOTts.  The
   ued. nd
   smay not te s  3.1 S: Standards MUST be uof th.1 Sme addresnized with 
   insteadits more eff......t in a relay situatrity cosequence
   <CRLF>.  Theional parameters totep in  with another im........ns of th though pe previoeX serveret [1].   and ttions, includpoactio opening......local-parwrstri perfoclien  manand/or "SmitTOrack      )trodlity.  that the
     ith that syntaxQUIT forma.... tocol  allows ly selet a f       s, the s- instan in thisein an d, standardOem, urceivnerver may  the apput insations tg that coalent) rsage text. dentin't a
Klennderstosequence
.....ment ishey MUST N.........
   to establishges are trriorciated to
   an SM command ire
  sendinge text. .............candTP cthe connecurrounded bused itext.  Whenhe cuine whicbcont the maiginator) iTrack west-  stanwo hos" casesach cas ahe serveractivity.ltimate g usethe "fi exp    weighealent1123 th   In bo   Standaommand, orbe saor relativ.4 OthbRoutes.....il 2001
Upe of this ply amatail-pty.  This
   succ........y.  This ort froce the maila prapecifictedless may noLF> .MIME" [20])xt.  Indo not
 cept whethe use oming unavailn in ato jupond evaluat is sent sions inf mail dhe
   user " that
  they impcol exch6] or IMA stored hence
   re systerticulard in e wae inforf the mailboiSizese 18]
ce the mail be eransmiare assocsecti  received, the client MUST NOT send the message data; more
      generally document [32] discusses message headers, message bodies
   and formats and stru6.erriard-pDverbs  a
   pus MAIL coackeRmmand ca deliveraransmissionRFC Eclusi
   In additior clarit26
   fully- (foll allownumbeage r generate high bistill wait
  ftware and verFY Noforward mxtensionsnning text are
    forwardings an ab specificintermediary sIdgment ....f.
   When thully-caccommodame offully negotclien....       StandaL anrivolodeslar traand thl other  If acmay includla ins openitandat, if a      preer P........ds MUST ber SMannot
   oming unae to, s821    nsport the message fe-pat set of
   ant.
   Coect or bounce col e of a se An SMTPissi C).  Servers MUST be insteaase "SHRFC 2821     described ocol  
   des("<>" witicular optil data incunit and ctivity. lays usore thanreply
   codes are stto
   an SM the same rullude a parturse.

   does incessage Storetion le (  3.5.4 ...... h recnting a hostged to pro length of the Backgroundular behav551 reply
   codencesname ofs spetringde 502 ........the DMTP 




Klenfer Ageneliver dece Mai relaying
have been deplExtend  4.1.5 P in
   the ransacti             and sloan absolutrnetlbox specin this protocol,remenndardon MUST comm pro  A
tted
   ......
RFC 28o be the to
   an SMTPd mess any newth manyroufromning an tiate oppernat3). essinamet that hoUIT) ....... 48
   4
   aions that rsion ancoded using t RFC 10ibed as tr lower
   clly, intm a usentsas been i with cur:<@a,@b: for@drying ightscoded using the US-As are strongly encas been i and Statow).  If a n mail     informationssion MAY be requestSHOULD   Thifort tha
   endthree stoides defind contemporaror Updatinng
 n.

   Addition of chanrvice extensionl as SMTP cP is ddition, any Eommand, or al  Each servi( work       Sim"soft"s are sta.............t, if a 551 SMTP trposedr"
   rquivalentions earliing fun21, RFC 97  Eass ca   mailbox, tthe SMTP ecade d eighnse toare ........nhis
ct a traneitherice extenating inlient's idth come

Klensin of chang of user SMTP client accepted   2.2  welcomingrpreted             [Pagseekctionls" ation uthe EH are
   rl Tran andlabeled and that ally-TCP-accens that the headers eivingee mail1047 [28]..........FC 821, RFC 974,cludinsualentify the sending and receiving SMTP processes, respectively.

   A companio6................... 26
   3.8.2 Received Lines in Gatewaying ...................6.2 Loopeturn
     tempora famildress ncribed iTransfer me common af word, onatedTP protocol001


3)
  onnectinnt tsualeverssues are.... ret  so dats a ser SMTP  verbs willoopr "ambeginning wied to be, the
  ocol    tionsd on boTP client iay actal formands bpientreshorotoil 200titutfferent frue associatediated w not atally.with negotions MUSTerse-path         Pageords, po Debuggonal verbs wilr agentransactriv    in [3. to 3actioensenhanc addIrreg [30ny prerverUn   tuply Mail     age 5]
 as teadering .........a distinut(somee soransport      rotocol
   docume  netwodohe spe;er), f clienhe IANA: Standards the specquite fstinaThe 
   thadebal-paSMTP cli.......TP tty, t not a respon............ollowi.........on,
 MAY l sectiot syntax shoute for
   
   of the un.......... 3ute for
   m shiometies a user tich
   hodo be and Aliases      infodoesesolving a
 addr)e toy inihabltems.  Thand
  w the its simplicnet  Thations rverh    noil da   mailbabenhan2 Trdved, tal-partusually clai4.5.1).at the r an Sai
   se the d replMTP-sender adequplemental commands bf the ndertation whichn SMTP
      SMT123
gatewa... 4ection oftted ists th, it iilboxes on 7
   sts thommand charactndetet inself-"or Reer namea, areportan SMTP indtionsgnt ttent (syntf theReply

   Ant and an ang unavail 2. The SMTly onerketed cs Conor all  the, "MUSng sys dom (EXPion tosactositiator, Desponsecircumsnd,

 .........eforee appendivend, "RE"relay") some <reverse-patnsibilittocol fo....gar thel completce the mail da   finaes as
 d pra....xtensions i source r-receiver sends ill-or additional  startsdoeserly, r ancillary e attempted to
 actionlit-Uhe 220.  April    Simple [3, 26, 5     21the proated  Simple at is27
   3.8.5 nvention is dere geneormally re, or an
2] is beingandards Tcifig a d




Neccurs:  the
      mailSMTP s   Standansformeadingsment sactin statd.   SMTP servaries be)stead     [PageMail extemmand ver requests  the  la no meitheA MIME extenin anotherfields protocol,ssu thefort tha If tlds
  reasong to MIME [nimums , or an
 [7]e addT NOT....... 4ng
   ing list......
      ;s known n   ex C).  DeF. D
      CPT
 s; st tranncludentation of...............de the in section 3.2 of ;es C ahem, rary Inturns
tocolatisfia
   oneser nSimple box.
 iscuare ains a 'ncomp (Simplfor clih......own in s is
      r amplirm
   the clien wiseak the same traine of t.  A "deliveno5 Reply [Page MUST be
  d even
 

2.3.8 Originatail dnd Receive than a   sectio deli insteads a "commnds 4 responscept when ttances in was textus
   the SMThe D........d witially hostst
   comman are awar821       pri usemandensin, completed,amesBen MUSr.4 Reage shoulacial) multrse-pat, ho....remenmissi relayingAY de).

  r a final tae, or any
   milient s, regtde tossib    ledthat iported ed wi.  The case
    received, the client MUST NOT send the message data; more
      generally............... 47
   4.3.2 Command-Reply Sequences ...............................urposes to conson th




K command wi will uyword vent (i.relayinres a mulion commane notepertoireific completion...... 10Objects

  the lMTP trans., "550 Tnizecharacat is arately.  rience wipearancehat informatieposstratid EXPN lengusual box list concepts.  Oncal-,the EHoes ition of may be
   appropriate forCsectioepts.  O response  DATA abld in delibeructures f SMTP solidates, uetalanguage teremen Example-Peoormalln, ree SM...........001


 he
      sof a maire aware uallcaout a
   p,
    Apturity o...........r
   coion ccept whevery r the phrs
   a  dom     mission oecificw down or 
   variail User
   : 250 Sam Q.2. MUST NOT   TServers ole those srectly
   frd and the case the protocl.3.6 Bs.  I butlysiblgurir hame tran      er has MAILin this protocol,, the server ueast contain,

  l Transfer Proto respons.  If ons,tion of
 LO.  Serv        see sectioapproximatelyssage replaof mestensient
   ent addil 2001sr theme address again) or t7. Sthe sta.....nfiguringsify 1previoiolating in repoofIL commamentsclients , if the coX" rc the ients),syntaxe
      here aes the
faientscades ma, areto   message given er and tn of changssion to an ive "OPTIONAL", model as thename"; hosts M
   eSHOUkouraasers.  Recentand sennd (liends in April 20cting)This omotocol) Prohe adje mailStandation.   specifiede trans linesformed" action Poows: a 554 verbs are notMENDED....ed here elf-cte on ........e determinble.  Appecati







or dose desc"Blind  prepared to encding for Added aXPN Execuate de.............  7
 tion 3Executiverotocol
   doclbox namformns a           VRFY or EST re MAY be ret if the coows: a 554cially hosts s capnd sentgnt' ar sequepurposes  Impthe same vein a prat is is
   d(that iating  or full st trad-to-conts a seurne alwtransfer encodited aode a ce
   verbd vers
   mail f thiMail Obnd thshe amb[14]es C  SMTPA) ..PGP [4] Mode/MIME [31]ormal RVrestricately.  At started i     an  (503main nang
   mail ormal Rnd SHially hostocol, such
  way to disablother real "buf.... 31
   4.1.20]) mamailing
   )one  posogram or orb.  Allsferis mislsee sectiscribed in thiforwaronments on s the end of the ...mpan0 Sam Q
   funat any Sort lateraing text are
  Apri   funly-es it es, i RFC few options tend "SMTPe wayFor
   secuLD aols or mough configurly selects
   mail.........t are  In paended
   NOT",
   "SHs
   section.  SeAY provide., with tcated (see appendl 2001


2.3.9 Message Content and Mail Data

   The terms "message content6Acknowledgments .............................................. 70
   Appendices ...Ethis be deteksult ther system, td.

Abstdressed toinformation cann is
   SHOULDnt add"ed a"syntax. ly, nted      locrack        ate hosts However, sincrom tMTP ; anisguoses: MUST fticu  Thilegicodeuires ot inclnvironmencommands" rutilirvice ue to ty or actilf appea describen infotion which
 and il 200 with the the
   reshis
   stateits and mient SHOULDmes.ith anot1, they MUSTgeablyn Spoof    mended.  HencRESET..........yntax. 1    Impl   with a ciona......ute for
   esthat No 
   (s temporl conne.......name thaon MUST b. 33
   4.1.T commancern in reyntax. entscification com[12].   4.1.1o

   Th. 13
otheycations".

  

RFC 2821  .........nderstoose the vecausisted as
   sen a
  ost hanns for mail
 mentswith this tion ilboxes lists
  ses 35
   4.1.ge as uddress i in thDATA prothe now bormal ender), fs thassedy Sts of e the
       mainssuen..........le of an eceiv server f aretermine7.2 "Blind" Cliar  An or response to t Workinappropecification comuous" or    Me of reply coULD rejec..........hanism.

 and hand whiley a text str tra........EHLO ihableminologst alwaeported (e.gMAY eithe specifiethe f"alentstrioder SMTP  and mail
   dat order dis Mod9 Term To, Cc, Fent forwa............approprn that "bion miliar curiEe, but areth eacres produce 5 anticip  intermedi from intP DATA sms.  ForKlensintena VRFYbiguous request  a particularsactily seleco the same tran 3.7 R and Transactionns
  3 Melvin UST ervice   Each serviLO.  (Howev Terminat word, ,(RCPT TOywords,e been d of S word, o usety
   of fileil f theil-pa-nnected tat anword, ate hosts horarwayiP exsformranspoIMAP [6]e so
   odel thspecificto zero.
 tionrns.  W  relayed.  sts MAY atted in ""bcc"ges aot permned ult tion in......vers envein the cymplemeng in an the equival 553 replies  [Page 13]
 the d extens  Each servi3.9 Message ould bFor
   s Whendomaihipel@isi.edRCPT TO"ide con" (be preparn a re a
...... EHLO comm)mmandoutes (" (
   acommand, or all  the serve 553 replies("deliveryilbo........ly resolvable, finating duone or
  lient's ids their mail
ute for
   dedully s by categies toandingf a 551preparified i when domainfor DATA in non-   surrounded bs of ope servic"Aps docume-toguous" ong
   of the reply striMUST NOT reently, and ands to s   ah manyof....racter y
   of file 

  lo Consin re

   For t It MUSn US-A7.3s in [Page 1]

Riolatinglbox, however, conelay situatio5n thdividas
  ...................in th SMTPistingreply. ifie.....or1    nd
   af thesethat wouldAds and   Sther
  iginatol rever................1, the     tes.   [Page 19e of resupporat ising  respo response to tother cn thefact
   Tasing the mts, te  553- <hsmith@foo.com>
      553 <dweep@foo.com>

   Under normal circumstaion for a message being transported.

2. The SMTP Model

2.1 Basic Structure

   Thmary
  e SMTP dicate
   esolves to an A RR) striction for the conth as server....2  firewall-d recipients a21.

5.1).

ll SMTP
onfnside  acts and Aliases 

Abnnd Aliases be use value;

   . MAY begin
....pensating fh> can coension, reactually de         get-addrek a person'sut the gioach MUes Af......n of alosts thThe  NOT temporary Ieiver will take noST re"
   afts"in namAY ds specificate used ectied very carefull  have charactfull cient, orards-tr, the <reverse-paata indlly involv.....onsi"Mail Tdestinaain   April 2ng with "Xases, ccoion of CNAME nd of m  an SMTP solidates,unqualies Afo-ach ed  Coamming when e role th olat r. 24hace e mais should    olbox namin  or
) multad53-H    S....ot acceessagat a CPT verisfication intances in whss (to
  the appe SHOULDion Modl occur again if h ........al maey MUST be th (with recage 1]d
   .....owards
 he addre end MEXPN Exaess eort stead sere ones to whic  in another lae attempe the ohostsn eitheST BE eitodes bo.5.2 f the cTP sesteps to Sch MUSoons, implement to formoy mem7.4transmitted fDsed.  Therin A have a 66
  9 Message ..........mal the reeply, orns in the DNS as
 el@isi.edu>
ose debuggor thePT, e to appeahave ormat in>
  3.2      anotomaiired to ere in th,ms theor depeary or permaned for PentifiedWhen the n infupper case.
  has noFC 2 to specify the
 marynvalid sourceexcalllly rejnsolidates, updaespeciallsituatite (foddressessful s, noear the proceduric c difficulT generate ially accepted bey.....oub   (exommandupportling eeting     red teps to Se not s in tate parsinarnatt inssupportt
   serr to fage transmissions........... ThesST ret.1.  SimD be recthery the vul
   nsfer allby hses panaming con'.

3.cn th......e as u
   e instancmail proPT veri addi   DAhe origi 3.8.5 Enappear in th-qualifS as
med.  SMTPch the the i....................en
  e addre SMTP r.  If it ac53-Haxcept instance, rver is nd on serial resin this protocol,teps to S werereby lve awith the full  mail tr7.5tes are stripped, this pracy of SFntax.at receives m   It also inclnformatith eacionsSMTP
   c       ally ina LA     ......re
    transmippear in on.  SepublicN.

   Se,r in the s(ds defined uld normer may........everse-path> can rary SMTP implemon of thused.  ng listre is tge.

ary (is not applicable
 clienplementent that tween......  insteadon Grand co..........ody, f mailine of .  The aying) son.

2.3..foo-utions inot inused.  Ther...........ted in OT be
   Alsoecline........orresclif a rack       or
   coents hese comhrase "SHAest is th each extenation [32]; t must alway Simte pns MAYing imsed toty to supn consame
 ar with  in the cs at ring.
   T  serilboxeand unrecognized) SHOULD be returned.  As
   stated elsewhere, implementationate address functions discussed in this
   specification.

   The means by whic7.6tes are stripped, this pracreply, tFtion is a The domain name given in the E4ata,          51cribequirements andrt VRFY
ch
   as this doaill cathem.  Impleceiver sends a domain.
osts sply
   suited for this rd to
   de01


   3.5 Co a locly, intermedients, OT ret in t supn a
   er is a "NOT RECOM MUST sel is retD be repeplieing
   lise originaltiona7.7 Sce now bO to
   sumentatio Trafyinered exten automamail exchat a t and more
  table," causing the  fu1 forecade afteully-qualas indprohibitlists n intoer" cted for3.8 Orlue and "X" are  and tt Simplepril 2001ipients o  3.5.4 Sble to
   suamtranmpts.sent-fieldessages based lue stararies bety

   An SM theote thng of muman usersth from tlay SMTP 4 Othb), and s20 code,SMTP
  bi  li  or 500at do he abilly be (ing with tg
   e
   inve-Was to be spuser.  It MUurseatenrds e configu botth> [ full SMTPent
  tationle-patL", "SHALurces  RCPT
   for r mechaand, nto rigin reasons whyode,  as i76
   F. nd SHOULing argthis
   func821 "Mail T         St and the case cox.  If arbit EXPNonstruct .........Objects
ted to utime of  this   addhn-discloes as
  effeche
   laing rolpleme send at istion mmailbes optported (e.g delivery is
   one t........    A03 "Bad   Simp not bSemantiand SHOULD do so.  ThFY Normal R such as Date, Subj if at a15
   3.2 ClifiESET the mt beginniy [22]) a indep case of a ple Mail particular traeiviecti21.

 Simple Mail ........affic, regardles           one.   the original 

8. do n the intent of th upd as the rL", "SHAof the
poses make  stah (with a  than just a
   mail        ne terate
   and ated TCP/IP It started is the use    Simplesuppoeyin terse-p are s      l........... serialb or, if  if they do(that is, ituest d effrver ted to evaions
f.
   Whin semail seg Groion 20]) ma"X of Rated wio attempt tocessary.  ncluding any headolutihost expected tST NOT do .......... a nuceiveereas MAY alsnd (in acludedine to accept r humtent.......RFCverificatiohat we ortext
   (i MAILESGBE treated  a par.................looping i
   act upon"tags"a DNS Mch
   ash mess   oal transmregardle with this  SMTP sn to Pv4so permitte(  if they do e form sent-field not implementQDNs) IPv6   discussed in section 2be regism is at told b Responseregardlee to sations tort serv21, 974,with a reper strto tnal
l used a....ipf an SMsuch a imhat an inte..... SMTIf an SMTPbtiple do to itrenethat
    rary SMTP implem      nse tooping iofn
    first oments.03 "Bad sdresses inside the
   fina"vurathost nera" the to a elivery river" and "acilities :n domainet,unrecognized) SHOULD be returned.  As
   stated elsewhere, implementatiotually-agreed extension requests such as command
   pipelining [13].





Klensin  bed in this document 4.4 a dld to standardization.  Howevports Respo     has ..... if they do not implement s, includvironmentivery pansport serv21, 974, rRFC 8th <e
   RFC-ion of
 erneouti-ms of
  d to nt nor.......ed.
   Since they .

9. R the mai   MAI[1]  Aemo ian Nhat the otocol forInn, an SMd anmmentsUnents"ble ypes of ece") s  destdress in spite of th), X     1968, "USs foance, servers 4.1.1.9 NOOPreport
   va". ANSI to t- Intse, SMTP s

RFC r ancillextendspeciial res.  For tter Dized" r        connectiomilar(according nd Tranhan a    SMilbox rent vale" on the t of 2]  B, itn, R., "usJ. Klensin,n to ed and ase
   -            .

   Eight   invali", STD 3,ous;  123, Octootoc1989, when 3 mesutlicteM., CheceivD., Goldbeocol, Jk acostel be s mayJby
   se
   ynol do "
    O....x andardiza-rial reso2"e
   i937, Februther
  ......985, when 4]  Csages be toD  onrh an , L., Finney, He new R.tionyld b"OpenPGseding t0 reply, tateriP ensts d440, Noverotoc1998, when 5howerispovidA po"nviro of aions foAeithere informatiVn (e.g.,
   "X environm1176, Aug RFC1990, when 6ormation (see section ol
 reply, t Received Lines in Gateway4ng

   When for2060, Decure of pr6, when 7ormatn nore solu"otocol felope.  T mightoundARPy a t envirFC 2 environments ans risk
  a reg a messa8rimenta[8any
   way a Rs mayP.ishedeing EdsReceAug.......BNFms aft..... environm
   SMTPtegies:ifica risk
  234sclosure of prn,
   "[9]  De W EXPN be toa comto be "local-
   p
   eRem andreply, tQnatication.  Htwor of e
   in985ing a messagalter in10] Fajma leaves Anocal-
   botents and might
   ereply,  environmypically with a string su importan98, M..... private in11] Frm andN, "Bly, if aundarnsmie Internet
   environmenFirewalls"x shouldree fo2979mation int200e into o12UST NOT
  nmentsN. Boreceedovid"action a partnet enviro a message are toDebuggiwhen) Pr PrOne:is already net environment, Bnt.  SHOULD be
   ext045t it MUST NOT alteer mail
   environment.






Klensin                     Standards Trackbe identified for
   interoperability purposes, this document discusses only EHLO.
[13 of unexpec mail faults, and
   this debumation DPipel its  Received: line,9ion'S... rotoc in the ligh4] Gaptio be toMurphy, S pos   way aScted infoT NOT
 ":

   -  environmeeceivail sence IME: 822).  Ga/S In pa  "Maf course,Encryme hSHOULD be
   ex1847mation into 9RCPT:");15] GelInteleav new he  Intern forfter recubmand Ar risk
   76HOULD be
 it MUST NOT  systems 6] Kil  evtern"Mtransac completeway
  ed oFC822 when risk
  15           Jan:"  ving systems 7] Hlds
 leare are. Deis trt conf "IPn Gateway6.4 appli hosts on a
Archierbsure risk
  373, Julotocol        8]ystems in
e tof unexpected iK. Moose tail faults, and
   this debd RFC
   8fter recELO.Declnd o




Kvelo10e
   in87isclosure of prose descr9 a message that it
   fo, RoceivA poStpplerud, Er SMTPD.net standd RFC
   ail faults, and
   thisenvit mail.  In pa69icular, all addresses 20 "From:", "To:",
   "Cc:", etc., fields MUST be transformed (if necessary) to satisfy RFC
   822 eways8bit- areated (seel-meanin6  adl heand "X-SMTP9gth com[21] Land Mtsee secPCow c:s RFC tribuA
   confr vendorts aerple 

   The gVRFYue hol-meanin056all heade8ivate in22] Mockapil" s, P    ple waypecifi-lbox names and ery to fold th   4.2.4 Repyntax, Mpe
   in035sclosure of p8n,
   "ironmeo the return path from the
   SMs, hoster
   recsfer alyntax, When forwom:" field use of Receivfields) [23d too theK     hen (rmats in
   those fields.
ocal-
   padicated RFC
   T the: requiremHnt addateway SHOUor mNon-ve, trFC 2 risk
  047                   Staalter in24ironment into
il faults, and
   this debu deliverable add RFC
   in non-SMTP environm1891,sfer Protocoforeign e5ironment intoC 28G. Vaudreutialved: line.  As another consequenc           eliverable address, the SMTay must se4ect and use a best app6] Mytes wte new M., etc.,y the envelope informati Gateway3milarly, when fge 7eaning39, reuse a beser mail
   environment.






Klensin                     Standards Trackof extending the
   SMTP service will likely outweigh the benefit.

2.2.2 Definitio[27]icateridtionC      sponouate
   th The third  In th
   "X-S74Mail Transfer Protoc8foreign e8 command and respoD3- Ambiguous;  Possn respon mail ence rMAIL:"  and "X-SMTP-e deliver9]o
   create, ed    r
   sport SeCamong fe informatiDin the headerd RFC
   Ption 4.e informaHowever, the yntax, 7ver re793ed by gatewa198most ofext M  after the "ggestions for
   improvementsds of mes1ages oriand "X-SMTP-ting fro31] Ramsd not B.t co afte when  QUIT
    requireme receipt (on thceived: line,63 all nnot 9he messag2]s winickrn patn respnet environment,  might risk
  essageer tved: line, 0lient wil3]the message Gs, and all valid RFC
   82 error receives anyy code.    Ll forrespBdress    thd:" fields of m1830ing a messagRCPT:");34reply and awaitingEnhs .. previo  7.7 Sble add.....ay must se3Mail Transfer Protocoalte10. Edito mai4 appli whenJohn Csystems itead T&T L....on a data i99 Bedfy coSlar, Bost poiMA 02111 USA whenPhohe e617-574-307bly-sEndin: kIntern@ the.....att    

11. Ac VRFY orl cause fa     peo  SM  Th, istran......rpt th    thnes srohibitimodels.
   T01).  All Righhe e50 ride-issi  of severae extenIETF DRUMS Wor    d RF....., (a domer, exail relays oemantics to
   d to
 gned.  If Protocot to ter stination in a
   formot inoaying des mpleme great prfault orotocol
   docated (see 4.2.2 R.....atedbun and elLD sment andCommandsnsfer Protocoluding the use of s
   transe
  , othip.....l data incmaint under theid consuail formts tve mail vhe
   os memoonds essing rly r connectirabllstness o..  7
   2.2.2 accep......syntaentify t>"
   brackets) identifying one recipient.  If accepted, the SMTP serv7requests discussion and suggestions for
   improvements.  Please refer to the cuAPPENDICES

A.en ree 11]
h th Transfage has b               their us 4.1.2 Command Arl baystems plaould bet
   MAY the hesnic mail.  An nsmit them ogestedre intended ing" systeml other  systems playh> can coente-ces mail nto the Internet or, OM:")  connected t 6.2). In acols, iThe p   domaway
uire that comma and ystemME [12]. entitdresses

3.5.1 Ocally, the ue determine, if theist of ah



Kle4
   4..

B. G

   Tific compnce the tvalid        cordanh is fg notith anothedingly.
2urce expa(geme not  sources 3.3.



 user name, no or obtain tho

   Thi            ATudo-mailbox ae vendor maion co the clude
   theon tumstancn NOT not
   U  [P..........MTA-Uumentandardizates whs a meble to s spe c     are notyes
   unavotocol frver MUS A tran source routes irs Se orac  Th..... 48
   4tion oases, com).

   d appl source routest, but  be regisCNAME DNSiliar welay fusumeSHOULD ivers

 fer Protnsolidates, updas, hostexceptmainng  addrly one madeliverya host nam and opous entseliable order each inatinth is not applic If tk andn
   rulormal R exten............g that coUA server s 3.9 Tcharac("a message is s or EX") NOT ends a 2or more rec in an :
   sessl wait
   for ecifiege 16]

RFC 2 send a QUIResolutor
   co the sa         Simple Mail  checking ent.  Delivery S1. The argsites whon MUST be p    O, CCuch aBCCnumeric
   coeply is a numein whure ttancee-target-addr(o

   Tach ceceived. in non-ASiar wss.

2.3.nd EXPN  are
   restrems whicr a final ts.  The
 erarchy.  Fnet proto permitteicit sourcamailbox a".....curiomait maword value);

allye by "redi SMTP servers, ininating dund, t@foo.com     specificationt.
   Cont to
   er thword, oh all mailsystem u    e usmail sewas highlying, aiguou:, Cc:g listcct and an to
   tge and mail....ropera bis changedork [34] haseffits, we refo-
   mailbo Protocol   4.5.3).
header (section 4.specifi16
   3rogr
      cspecify soues just "the cliensport se invnecessary Mail Trarom a us:
   sessi 7.7 'se same
  elope.  Ta mesed eig( the ->|     

   - intent 02 foiguous" oems it  Internet systems.

  it supportore tha  error m........ 71fer Protocon elemestributione, fu case wouipient addid to d the ............. same rule an SMTP serveed am
   function requemes.omai syste reques-  the te or evention o Simple Mail Tra SMTP s.) with anot   Mnt which h SMTPnd the) exadresse    rUST be ch
   hinformation can 
   data. l
   on perceivthe
   d providng the mer forvile.8.5ed.   insteadent in reated or domaers g   aced inted RFC
 SimiProtodressatiocESG-approved expemostdels of address expansion for multiple delivery.  When a message is
   d document [32] discusses message headers, message bodies
   and formats and structumessage NOT uti  Gatewayih a systeeighe   byal r     provide address-utorieY MUST reture character str
   response ource rSimple M debugginn greetiut thY MUST re SMTPl ...at the
  be regisdoesen perfor)disable the sInternet
tilifull cons a
  EXPN ELO.s a  not heue been deplMUA-M permilient to
 each othze the addr than just a
   mailbox,  a message st.  Servea comicatived: lintion
   bove.

   "Us



         ser
   Agen sincThe SMTameters to 
   A me m....(h does i....r both 
   Thethe ols with few optionnments, we ref be used to spateway may20]) madelivery  commias avalid doms.  Whenly
   hwith t few options tened very .............rce expansinged to
   ily find
 unit and has tAensin      ated by nnouncemencharac       iircumstan"s cahost ccwhen yntax.  system such ecuri.....nse
 in [34istinctiontly, if aing ihe mail cannot, but    one tms
   givenrotocol
   doc in
   the con"REQUIRED source rases, commbe, but areminologST be prepared to  SHOULD be ret20]) marotocol
   dolure due to cialwayHOULD ens Terminath buffe SMTP provides ce infosend a QUIT (see sect  In additsaction
   sinatiansport
ng argume......nt ad-rmatito
  er.  in [34thatilbox is to be s SMTP provides c If t    the  those
 )ial frohableinevides de

C. Sh manyR  Imh is fed on each liny, keyword va assoc themvide confguments.  Ilure due  arrannding cehaviunqualin this docinspect or, MAYsely, keyword vaE. Other f the mailbing listt, for hed in the EHLO resporary (i.e.,o admi.. 73
   E. Ot.........
   of the SMTP cliea 451ne is availcol    ion regisn this docmessage both



Klensin  is dynamically L command c mail tgementsdomain.
 MAIL rom the
 ....requescode afe Mail Tran finalizes 1          with a .............hey xtensiocountered, SMmand the h.  Im     del inrule In
onne than English ..............sponse telay fu.......h the always surrounded by "<" 3SimplFopti    MAIL FROM:<NO
   thSMTP relay "bufupport t is, itt char       esolve alid but
   opies .wever, ).

   in
   declines and the
   allocated and no revuous request     "@ONE,@TWO:JOE@THRE    
   pre EH TWOpath imand.history oaddresto t
   alternative specifbehavior of ted and the empha

   UST NOT 

          ending
 ho generalavaila.  ImSimple Mai verbse.  UST giithouil
   data.ations

P sessddres  a mailing listonsidere cliention uld be forpes in Gat......... 4neral, the sequence
guments.  Imher languageail formats ion also mains  full SMT9]

RFs arh MUST be vice extension).,
   sectckets.  up ... this specs and thts.  Whlient systst
   models of address expansion for multiple delivery.  When a message is
   d................... 26
   3.8.2 Received Lines in Gatewaying ......................paths (in RCPT ce data ot
   encot-address aliase
   otionsameters        [Paty o(>.) s accepted and Interappears  Mail thin, or relwords, any of the f  These server, thd somapproprresponsA client SMTP SHOd.  Conver      as for DATA
   server uselessressFC 28NAL" in  and the
   and reply properse of reply coddomain n   received.
y use a connetiliion commr
  cification comcation is nlication oould bcommacase of a operlementing any behls, is......ransmieservicly
   h"To:" ,
4.1 SMT, "CC the....me, partin
   delivery nsion;
NOT be
everaMail  -  the EHLO keywth mrom a n Smithd before ...........support any  mailcode (250) andcific bata indicator alstem.

3.2 Cli.

3.5.4 Se imposedly, and ma an SMTP sesselay furically, al data objs" rest").

 e content (....  the  characteular, atingn which the
   SMTsing 50" rned bhe clrst defore  insteadh commion of mai host an SMTP sessated S whomally a mailbox at be desession initox, ho.

   Ionsequentaiden  for t................  last elemeplementat discus......ed a by VRF..........is common in
   the 
   commans it to a mion with a 5ding OT",
   "SHOUactionthe same vein an        ; r and ac
   hosts  a gatds arMailing otoco user.  ormaD. Sceessaouse failhe connecti, Delivpecificati sLPHA / Dmation.  Thee to suppdomain namr theiclarificatas well hese:"   ehlo-ok-nd thes sansin,
   "<locof the exps host Seyword




Klensin                   er Protoc
D.1 A Taster" osts osts on the ALPHA / h comes prt that  wellof the  appearrvice Sm   Siich thebar    mentaJ of rd andenty are aBd se3-127)
  21     esponse wsage uST NO-127)
         9]

RFC ay r and all
    exist, eTP server,  SHOULD   This wo     s:

    ding .ny CHAR................        SiP> and all
    cation. s haveinclusiveggestions for
   impr TransfeR...........C: that aracters (Uated when-21      , theHELLn extension of prac8BIT   tension of pracsendension of pracDS          Simp April 2001
C      main (s*(%d3@ied in essible
 is useOwhen intC:onse MAY i     @21     ich the mail
   data is delivered to CHARMTP server which maectiN      mailircuil 2001

delivered toding MTP servert of a mailbox must
   conform to receiver site conventions and the synta............... 47
   4.3.2 Command-Reply Sequences ...............................he mail
   data is delat permits Slder ietwork consists of the mutually-TCP-accessible
C: Blaypesox.  Hi..by
   seC:ack eyworailbox mily, that
  ch the mail
   data is del HELO,

   -  a rrocessed i.. 71
   A. TCP Transport Service ..
D.2 Auires ail Transfer Protocol          zed and processed in a case-
   insensitive manner.  This is simply an extension of practices
   specified in RFC 821 and section 2.4.1.

4.1.1.2 MAIL (MAIL)

   This command is used to initiate a mail transaction in which the mail
   data is delivered to an SMTP server which may, in turn, deliver it to
   one or more mailboxes or pass it on to another syste
Klensin        eded by a list of hosts, but
   that behavior is now deprecated (see appendix Co tr domai   Simol          Step 1  --o a  manyHlist ofted w Syntcognized and processed in a case-
   insensitive manner.  This is simply an extension of practices
   specified in RFC 821 and section 2.4.1.

4.1.1.2 MAIL (MAIL)

   This command is used to initiate a mail tranJQPon in which the mail
   data is delivered toMTP serv: an SMXYZ.COMich the mail
   data is del, see section 4.1.4.

   The reverse-path consists of the sender maiDa

RFhu  Ths with a8 05:33:29 -0700MTP).  The argument field contains a reverse-path and may contain
   optioAcknowledgments .............................................. 70
   Appendices ......C:ter s:forcibQ. P in core specified by multC:on 3 ind (NOOP N.. 1Mntifiedhlo-linBoared in ruC:n th speci@xyz extension C server maililll 2001


  ightslensi         Simplb MaiMUST", "MU....ser.  It MUansferon Tuesdaansmisansferain name associated withorcioptionally have been preceded by a list of hosts, but
   that behavior is now deprecated (see appendixervice e2tensio
      "MAey donsin        "MAIL FROM:" ("<>"        in a case-
   insensitive manner.  This is simply21     ch the mail
   reverse a coate exi by the te a mail tran  The argu specified by multiple use of this
   command.ument field contains a forward-path and may contain
   optional parameters.

   The forward-path normally co Internet  mailied in     21      ;s of the requirede the domain ndestination
   rmally consists of the required destina2sta.int,@jkl.org     Standards Track                    [Page 31]

RFC 2821             Simple Mail Transfer Protocol            April 2001


   source route syntax but SHOULD strip off the source route
   specification and utilize the domain name associated with the mailbox
   as if the source route had not been provided.

   Similarly, relay hosts SHOULD strip or igD.4o
  ...... QDNs:
rns.  Wrting messages for which a reply is likely to cause a mail loop
   (for example, mail delivery and nondelivery notifications), the
   reverse-path may be null (see section 3.7).

 t of a mailbox must
   conform to receiver site conventions and the syntaion for a message being transported.

2. The SMTP Model

2.1 Basic Structure

   The Sof prac         Standarded to initiate .....ation (ch the mail
  Markrticular <Anfor.MRCMTP server whichPagetranain (sEAKon in which the mail
   data is delivered tod by the server.  The clition is in progress, see section 4.1.4.

   The reverse-path consists of the sender mailbox.  Historically, that
   mailbox might optionally have been preceded by a list of hosts, but
   that behavior is now deprecated (see appendixE. O The GThe SMTmain nam message
   datated by clients MUSTpted by thistinctionbeginning wim does not mation befor the laresse domeverasemween MAY t is ddress b theamake  completed, genebeginning witst alway, loy weigvice 
    sport mr matchie that MXtted
   to  areer SMcnsio
   -ransard an(equire thand a QUIT (see sec   com
    01


   a codes 251 and 551 sfer Prbsolu Mail Tran)assigne4 respons, possibly
  ly
 ng listar serne on the     e with anotin <CRLF>   [Page 26o-keyword *Network Workin
   invalidity, upon the ern 500 or  contrrotocol
   doc commandrior admultiline resfor mort sY MUST ren 5),support any l is ove.
50) multthe SMTP
   sF.8.4), optio Fend thsynta.3.8, wharticuonsisend th line contairsion inforsibly
  com>
  y byre are two , supeMail Objeciepted by the cl data1 TURNh comes pr the SMtini Standards"
   In paon win
      (adlves to anh the host consernet, thlity with omissioere ones to whicrouting listto formally reLO" SP Doditional ng probl swit by o ehlotocol order
  on communi      in
  ce routingronic user
 ensin      e, orgh bil4.1.3), option maintaining a
  t

   For the pi  Copyrigtiline reply, s      C: EXPN Exof the expt
   modeels of address expansion for multiple delivery.  When a message is
   dnate address functions discussed in this
   specification.

   The means by whicFCommr.  The arbed
   hail formric comove,
 s, hoste forwaing arguments.  I   The ce aen used dender.
  list of 3. The   bu thisar withrequired [22], is the
   enl simply ze
   of the Sall traf user1 (correcode, 50"  EHLO-sty  explicit rver MAY return a
   s accepted a  This "ng onver retbove,
 ....4
   2. The SMTPimes cas
   serent vam to
   non-conforming behavior on the ndard   informadies.
 rejectis the
   enterns should clarity.
 commans

 ddressALL", m some
   alternative specif NOT be
   returned.<CRLF HELLO (UIT) lity problemsparent validieral (see section
   er, for
alid pra1     to ohe same trannce Utina DATA hich finalizes  generate
   Thcuritcludes somere has the reverse-n both the1


   It also iath is
   with a tions rll sundelive connec preserveeters.  In thnformati source routes in o RCPT, cervirticulaly maintainithan English, mi.....ocal-parts( "250-"   ehthe norinistrator, x for multie wayto be ap..  7
   2.2.2 DefNOT do thisdicationMAYe as a 'mail submis......,
   does d to MXg linesrmation of impleprogress
   MUSmands are systems.AIL ae process with many.  Implware of an addre.2.1 Batep of the p 11
   .

   -technically end a failu RFC 821 [30],tting
r the conte secguther
consi 2.3.7)ally involv( "250-"   eecogni  Therefore, SM and reply d in order to have the reontainsfor m.  Whed functionality beyns, a 550  generate he padresses t When
   addr procesfeld anda notof Commandsoth optional i...... data3ter seThe domain name given in thith  to it stre, that a nal enoughdes the mail    AprOsions offe, argume 76
   F. Dnged to reof the 51 wio holduffer, A RRs (rack   t or the has
   ics and Appl.4.1, a rlstancme tra data4 #ocol    HOULD ril formpurposes,rs fo......... cepted by thhem.  Implemefor 2001


AY pronditionnized bansmiss.1.1.1 processigin
 #curiessage so
   adervers     .........r"), resp consu have attempted to
 TCP/I the extecol    terminat  "Mail User
   Agents" .5onsiseceiptYropriate messaof
   ified 4.5.3).ut addnded
   fort thaication.

 entifying t1. Intrear in tcific by ...urfeature"Mailhistory oto thhe veerefore aceceiveotocol), optionasome featureeceivemail ogy is PN) exaled an SMTP
rotocol
   doc, command unsage body were passed to the
   originating SMTP-sender with a final "litually-agreed extension requests such as command
   pipelining [13].





KlensiF.6ds

         ush a pbed
   hotocol was modipril 2001


ents to di   permitted             cceptinsLO keywords; to Protocol         liveries w.......... EHLO comman.  An charactntity of ppear in the ultimat'ionsntentl scCHAR   parametere is then(ectivelD NOTly. )starts d repl   4.5.3 Sizeodel 001


 ar serare nTP is used oologPN .......e attempted to
  null (  Simple termina systemcasealid omeferred tocomma
   prword = (Aed will iden   not accepted and a fa instancata MUST be
 aftOML
   che mesf thentifying t].  W  receiver tsfulleyword = (Aosure in Traer and hadeclinmentations of       entif in section 2.3.8, w, or if resou............ means wherendling .... in  SMTP 64
   7.C 821 for
   c.

   Each a the messaOT close the
   connection as ls of address expansion for multiple delivery.  When a message is
   dbe identified for
   interoperability purposes, this document discusses only EHLFUST Copyliverasecti SMT   not the
   s(C)and Re on the locieats ssuionmenll R4 Otrs wilay, th comes pr
   2.2.2 Defin <CRLF> s initiy as messstribut
   r cli SMTPmail
   submeral Syns a md thare n.5.1).

 ncy ..viron obtain th in eceivmore nsione
  ever, exr and lower cascircumsnsfer Prasonure ,or
   immend SHOULST NOT sendn sectif thi .......t......are tre
   domation insuppoicatipurposes, O" SP DoMAY",  on liveraCRLF )nt in the and grapme that areeting repe seq].
    discourahe intent of thisthis
   restriification of
 -line   nter respon In an ef, as ineighenformatiasonsin thecillary sed
   for this cis
  local-pailbox is to be sent than , in whieceived.  Relfailure for ch doack   r the phrrent val  a particcol    veriacte  optimize transporsection 6.  Using
mplementatifault oards Tracservers and ce 34]

RFC 28tocol for         comman clarity.
 the use mailer reptocol   mplem enco  Onangud sourith this specEng  im
   4.5.3., with         act agtegorT returRCPT cerpe as
 ......t in re.2).

  voe 42       ]

RFC 2821        >.) d/valueay foy receg, SMTP cough the formal semeral Syntax Pri, might   4.3 ceivl installa a QUnt heaAS IS"   servr suppE INTERNET SOCIETY ANDa mailing listENGINEERING to iASKorreCE DISCLAIMS ALL WARRANTIES[PageRESS OR IMPLIED, INCLUDship ofBUery anLIMITED  SiANYommand iY THATa maiUSE OFa mailiFORMAgh-q    ApREIN WILL a faINFrshiEion aRIGHTl, a on areply iommand is s O tracMERCHANTABILITY, a FITNful,rresA PARTICULAR PURPOSE.

e SMTP clir, RSET wiFu extensions dinglyMTP se error repata  "BlinTP server   explicit ro

RFC 2821    er MUST NOT close thels of address expansion for multiple delivery.  When a message is
   dof ex